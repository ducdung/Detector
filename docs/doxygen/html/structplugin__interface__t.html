<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="keywords" content="TEMU, dynamic analysis, binary analysis, dynamic
taint analysis"/>
<meta name="description" content="C/C++/OCaml Source Code Documentation for the TEMU Project."/>
<title>TEMU: plugin_interface_t Struct Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head><body>
<p class="title">TEMU: Dynamic Binary Analysis Platform</p>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="classes.html"><span>Data&nbsp;Structure&nbsp;Index</span></a></li>
      <li><a href="functions.html"><span>Data&nbsp;Fields</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>plugin_interface_t Struct Reference<br>
<small>
[<a class="el" href="group__main.html">temu: Main TEMU Module</a>]</small>
</h1><!-- doxytag: class="plugin_interface_t" -->primary structure for TEMU plugin, including callbacks and states  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="TEMU__main_8h-source.html">TEMU_main.h</a>&gt;</code>
<p>
<div class="dynheader">
Collaboration diagram for plugin_interface_t:</div>
<div class="dynsection">
<center><font size="2">[<a href="graph_legend.html">legend</a>]</font></center></div>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Fields</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#c9a05334a071d1a4247039c4e024e60f">after_iret_protected</a> )()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This callback indicates an interrupt is returned.  <a href="#c9a05334a071d1a4247039c4e024e60f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#5d9d02e1a4f88a1bda09094f0a7729d5">after_loadvm</a> )(const char *param)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#f2ac126ff082dc76836022840e6d2674">bdrv_open</a> )(int index, void *opaque)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#249e490e627bcace802fcb13097df006">block_begin</a> )()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This callback is invoked at the beginning of each basic block.  <a href="#249e490e627bcace802fcb13097df006"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#6bb3637da58843e312aacf955967b8dc">block_end</a> )()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This callback is invoked at the end of each basic block.  <a href="#6bb3637da58843e312aacf955967b8dc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#84197690d4d5bd9f1f9e44581cebf3a5">call_analysis</a> )(uint32_t next_eip)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#414abf8a059b4015cea043be17e34da6">cheat_sidt</a> )()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#1435a522c62938a9b98a3ba7b10cfb2d">cjmp</a> )(uint32_t t0)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#6b5c7f7531b26b63e71786b17f10ef18">do_interrupt</a> )(int intno, int is_int, uint32_t next_eip)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This callback indicates an interrupt is happening.  <a href="#6b5c7f7531b26b63e71786b17f10ef18"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#9121b74277d2d4bff2042f16462f7eec">eip_tainted</a> )(uint8_t *record)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#993329f07169671277d326718e7b993d">guest_message</a> )(char *message)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This callback handles OS-level semantics information.  <a href="#993329f07169671277d326718e7b993d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structterm__cmd__t.html">term_cmd_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#5785be014fd4e4a1f3ec50f725bca514">info_cmds</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">array of informational commands  <a href="#5785be014fd4e4a1f3ec50f725bca514"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#f9fa85a2a68c5ea08803c8a244614453">insn_begin</a> )()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This callback is invoked at the beginning of each instruction.  <a href="#f9fa85a2a68c5ea08803c8a244614453"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#6adec47f9f0541e921058692b1fa5798">insn_end</a> )()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This callback is invoked at the end of each instruction.  <a href="#6adec47f9f0541e921058692b1fa5798"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#2ee53fc1918838c58f2c574562b24e40">mem_read</a> )(uint32_t virt_addr, uint32_t phys_addr, int <a class="el" href="taintcheck_8h.html#c5171f8c3bbd36e5425e886a5e20e790">size</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This callback is invoked when the current instruction reads a memory region.  <a href="#2ee53fc1918838c58f2c574562b24e40"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#dd4182588b3fe9c6d815c5b38b9f4625">mem_write</a> )(uint32_t virt_addr, uint32_t phys_addr, int <a class="el" href="taintcheck_8h.html#c5171f8c3bbd36e5425e886a5e20e790">size</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This callback is invoked when the current instruction writes a memory region.  <a href="#dd4182588b3fe9c6d815c5b38b9f4625"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#738038bc4fd5a2ab5399a878886a6e63">memreg_eip_change</a> )()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#60b5ab751ae4d15984244a780929a2d9">monitored_cr3</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">CR3 of a specified process to be monitored. 0 means system-wide monitoring, including all processes and kernel.  <a href="#60b5ab751ae4d15984244a780929a2d9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#9f19c6d8662ab7784a598f729f951338">nic_recv</a> )(uint8_t *buf, int <a class="el" href="taintcheck_8h.html#c5171f8c3bbd36e5425e886a5e20e790">size</a>, int cur_pos, int start, int stop)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This callback is invoked when a network packet is received by NIC.  <a href="#9f19c6d8662ab7784a598f729f951338"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#461e4e6270fd31ef6c4fa6e076f69dab">nic_send</a> )(uint32_t addr, int <a class="el" href="taintcheck_8h.html#c5171f8c3bbd36e5425e886a5e20e790">size</a>, uint8_t *buf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This callback is invoked when a network packet is sent out by NIC.  <a href="#461e4e6270fd31ef6c4fa6e076f69dab"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#893b0321029bbf4619a76d719486ff27">plugin_cleanup</a> )()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">callback for cleaning up states in plugin. TEMU plugin must release all allocated resources in this function  <a href="#893b0321029bbf4619a76d719486ff27"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#655dd7f42359c9e4fc0c00186492d4ba">pre_mem_write</a> )(uint32_t virt_addr, uint32_t phys_addr, int <a class="el" href="taintcheck_8h.html#c5171f8c3bbd36e5425e886a5e20e790">size</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#83d37405cce213c4766e1bfbe6f9813a">read_disk_taint</a> )(uint64_t addr, uint8_t *record, void *opaque)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#f9db66146dd22bdad23b09bf2f013a6d">reg_read</a> )(uint32_t regidx, int <a class="el" href="taintcheck_8h.html#c5171f8c3bbd36e5425e886a5e20e790">size</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This callback is invoked when the current instruction reads a register.  <a href="#f9db66146dd22bdad23b09bf2f013a6d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#80ee4e68586dbf9579df2f774001b01b">reg_write</a> )(uint32_t regidx, int <a class="el" href="taintcheck_8h.html#c5171f8c3bbd36e5425e886a5e20e790">size</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This callback is invoked when the current instruction writes a register.  <a href="#80ee4e68586dbf9579df2f774001b01b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#4cca549b7f2c09fa47d356115741dd78">send_keystroke</a> )(int reg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#7f646c69e77b630c1cda6f206ca125d6">taint_disk</a> )(uint64_t addr, uint8_t *record, void *opaque)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#9d9c6f38a85ffe4738755a465115c94f">taint_propagate</a> )(int nr_src, <a class="el" href="structtaint__operand__t.html">taint_operand_t</a> *src_oprnds, <a class="el" href="structtaint__operand__t.html">taint_operand_t</a> *dst_oprnd, int mode)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This callback customizes its own policy for taint propagation.  <a href="#9d9c6f38a85ffe4738755a465115c94f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#cf6b2847bc302d9e0c94ca21fd81a75d">taint_record_size</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">size of taint record for each tainted byte. TEMU sees taint record as untyped buffer, so it only cares about the size of taint record  <a href="#cf6b2847bc302d9e0c94ca21fd81a75d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structterm__cmd__t.html">term_cmd_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugin__interface__t.html#9d8d8731debe4e3f0e17bc9124f0d2ad">term_cmds</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">array of terminal commands  <a href="#9d8d8731debe4e3f0e17bc9124f0d2ad"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
primary structure for TEMU plugin, including callbacks and states 
<p>Definition at line <a class="el" href="TEMU__main_8h-source.html#l00293">293</a> of file <a class="el" href="TEMU__main_8h-source.html">TEMU_main.h</a>.</p>
<hr><h2>Field Documentation</h2>
<a class="anchor" name="c9a05334a071d1a4247039c4e024e60f"></a><!-- doxytag: member="plugin_interface_t::after_iret_protected" ref="c9a05334a071d1a4247039c4e024e60f" args=")()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structplugin__interface__t.html#c9a05334a071d1a4247039c4e024e60f">plugin_interface_t::after_iret_protected</a>)()          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This callback indicates an interrupt is returned. 
<p>

<p>Referenced by <a class="el" href="TEMU__main_8c-source.html#l00557">TEMU_after_iret_protected()</a>.</p>

</div>
</div><p>
<a class="anchor" name="5d9d02e1a4f88a1bda09094f0a7729d5"></a><!-- doxytag: member="plugin_interface_t::after_loadvm" ref="5d9d02e1a4f88a1bda09094f0a7729d5" args=")(const char *param)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structplugin__interface__t.html#5d9d02e1a4f88a1bda09094f0a7729d5">plugin_interface_t::after_loadvm</a>)(const char *param)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="TEMU__main_8c-source.html#l00285">TEMU_after_loadvm()</a>.</p>

</div>
</div><p>
<a class="anchor" name="f2ac126ff082dc76836022840e6d2674"></a><!-- doxytag: member="plugin_interface_t::bdrv_open" ref="f2ac126ff082dc76836022840e6d2674" args=")(int index, void *opaque)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structplugin__interface__t.html#f2ac126ff082dc76836022840e6d2674">plugin_interface_t::bdrv_open</a>)(int index, void *opaque)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="TEMU__main_8c-source.html#l00084">do_load_plugin()</a>.</p>

</div>
</div><p>
<a class="anchor" name="249e490e627bcace802fcb13097df006"></a><!-- doxytag: member="plugin_interface_t::block_begin" ref="249e490e627bcace802fcb13097df006" args=")()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* <a class="el" href="structplugin__interface__t.html#249e490e627bcace802fcb13097df006">plugin_interface_t::block_begin</a>)()          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This callback is invoked at the beginning of each basic block. 
<p>

<p>Referenced by <a class="el" href="TEMU__main_8c-source.html#l00494">TEMU_block_begin()</a>.</p>

</div>
</div><p>
<a class="anchor" name="6bb3637da58843e312aacf955967b8dc"></a><!-- doxytag: member="plugin_interface_t::block_end" ref="6bb3637da58843e312aacf955967b8dc" args=")()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structplugin__interface__t.html#6bb3637da58843e312aacf955967b8dc">plugin_interface_t::block_end</a>)()          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This callback is invoked at the end of each basic block. 
<p>

<p>Referenced by <a class="el" href="TEMU__main_8c-source.html#l00505">TEMU_block_end()</a>.</p>

</div>
</div><p>
<a class="anchor" name="84197690d4d5bd9f1f9e44581cebf3a5"></a><!-- doxytag: member="plugin_interface_t::call_analysis" ref="84197690d4d5bd9f1f9e44581cebf3a5" args=")(uint32_t next_eip)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structplugin__interface__t.html#84197690d4d5bd9f1f9e44581cebf3a5">plugin_interface_t::call_analysis</a>)(uint32_t next_eip)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="TEMU__main_8c-source.html#l00658">TEMU_call_analysis()</a>.</p>

</div>
</div><p>
<a class="anchor" name="414abf8a059b4015cea043be17e34da6"></a><!-- doxytag: member="plugin_interface_t::cheat_sidt" ref="414abf8a059b4015cea043be17e34da6" args=")()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* <a class="el" href="structplugin__interface__t.html#414abf8a059b4015cea043be17e34da6">plugin_interface_t::cheat_sidt</a>)()          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="taintcheck_8c-source.html#l01725">taintcheck_sidt()</a>.</p>

</div>
</div><p>
<a class="anchor" name="1435a522c62938a9b98a3ba7b10cfb2d"></a><!-- doxytag: member="plugin_interface_t::cjmp" ref="1435a522c62938a9b98a3ba7b10cfb2d" args=")(uint32_t t0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* <a class="el" href="structplugin__interface__t.html#1435a522c62938a9b98a3ba7b10cfb2d">plugin_interface_t::cjmp</a>)(uint32_t t0)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="taintcheck_8c-source.html#l01461">taintcheck_jnz_T0_label()</a>.</p>

</div>
</div><p>
<a class="anchor" name="6b5c7f7531b26b63e71786b17f10ef18"></a><!-- doxytag: member="plugin_interface_t::do_interrupt" ref="6b5c7f7531b26b63e71786b17f10ef18" args=")(int intno, int is_int, uint32_t next_eip)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structplugin__interface__t.html#6b5c7f7531b26b63e71786b17f10ef18">plugin_interface_t::do_interrupt</a>)(int intno, int is_int, uint32_t next_eip)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This callback indicates an interrupt is happening. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>intno</em>&nbsp;</td><td>interrupt number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>is_int</em>&nbsp;</td><td>is it software interrupt? </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>next_eip</em>&nbsp;</td><td>EIP value when interrupt returns </td></tr>
  </table>
</dl>

<p>Referenced by <a class="el" href="TEMU__main_8c-source.html#l00550">TEMU_do_interrupt()</a>.</p>

</div>
</div><p>
<a class="anchor" name="9121b74277d2d4bff2042f16462f7eec"></a><!-- doxytag: member="plugin_interface_t::eip_tainted" ref="9121b74277d2d4bff2042f16462f7eec" args=")(uint8_t *record)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structplugin__interface__t.html#9121b74277d2d4bff2042f16462f7eec">plugin_interface_t::eip_tainted</a>)(uint8_t *record)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="taintcheck_8c-source.html#l01477">taintcheck_check_eip()</a>.</p>

</div>
</div><p>
<a class="anchor" name="993329f07169671277d326718e7b993d"></a><!-- doxytag: member="plugin_interface_t::guest_message" ref="993329f07169671277d326718e7b993d" args=")(char *message)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structplugin__interface__t.html#993329f07169671277d326718e7b993d">plugin_interface_t::guest_message</a>)(char *message)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This callback handles OS-level semantics information. 
<p>
It needs to parse the message and maintain process, module, and function information, using functionality in <a class="el" href="group__semantics.html">OS-Aware: OS-level Semantics Extractor</a>. 
<p>Referenced by <a class="el" href="TEMU__main_8c-source.html#l00251">TEMU_virtdev_write_data()</a>.</p>

</div>
</div><p>
<a class="anchor" name="5785be014fd4e4a1f3ec50f725bca514"></a><!-- doxytag: member="plugin_interface_t::info_cmds" ref="5785be014fd4e4a1f3ec50f725bca514" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structterm__cmd__t.html">term_cmd_t</a>* <a class="el" href="structplugin__interface__t.html#5785be014fd4e4a1f3ec50f725bca514">plugin_interface_t::info_cmds</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
array of informational commands 
<p>

<p>Definition at line <a class="el" href="TEMU__main_8h-source.html#l00297">297</a> of file <a class="el" href="TEMU__main_8h-source.html">TEMU_main.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="f9fa85a2a68c5ea08803c8a244614453"></a><!-- doxytag: member="plugin_interface_t::insn_begin" ref="f9fa85a2a68c5ea08803c8a244614453" args=")()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structplugin__interface__t.html#f9fa85a2a68c5ea08803c8a244614453">plugin_interface_t::insn_begin</a>)()          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This callback is invoked at the beginning of each instruction. 
<p>

<p>Referenced by <a class="el" href="TEMU__main_8c-source.html#l00513">TEMU_insn_begin()</a>.</p>

</div>
</div><p>
<a class="anchor" name="6adec47f9f0541e921058692b1fa5798"></a><!-- doxytag: member="plugin_interface_t::insn_end" ref="6adec47f9f0541e921058692b1fa5798" args=")()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structplugin__interface__t.html#6adec47f9f0541e921058692b1fa5798">plugin_interface_t::insn_end</a>)()          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This callback is invoked at the end of each instruction. 
<p>

<p>Referenced by <a class="el" href="TEMU__main_8c-source.html#l00527">TEMU_insn_end()</a>.</p>

</div>
</div><p>
<a class="anchor" name="2ee53fc1918838c58f2c574562b24e40"></a><!-- doxytag: member="plugin_interface_t::mem_read" ref="2ee53fc1918838c58f2c574562b24e40" args=")(uint32_t virt_addr, uint32_t phys_addr, int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structplugin__interface__t.html#2ee53fc1918838c58f2c574562b24e40">plugin_interface_t::mem_read</a>)(uint32_t virt_addr, uint32_t phys_addr, int <a class="el" href="taintcheck_8h.html#c5171f8c3bbd36e5425e886a5e20e790">size</a>)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This callback is invoked when the current instruction reads a memory region. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>virt_addr</em>&nbsp;</td><td>virtual address of memory region </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>phys_addr</em>&nbsp;</td><td>physical address of memory region </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>size of memory region </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="dd4182588b3fe9c6d815c5b38b9f4625"></a><!-- doxytag: member="plugin_interface_t::mem_write" ref="dd4182588b3fe9c6d815c5b38b9f4625" args=")(uint32_t virt_addr, uint32_t phys_addr, int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structplugin__interface__t.html#dd4182588b3fe9c6d815c5b38b9f4625">plugin_interface_t::mem_write</a>)(uint32_t virt_addr, uint32_t phys_addr, int <a class="el" href="taintcheck_8h.html#c5171f8c3bbd36e5425e886a5e20e790">size</a>)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This callback is invoked when the current instruction writes a memory region. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>virt_addr</em>&nbsp;</td><td>virtual address of memory region </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>phys_addr</em>&nbsp;</td><td>physical address of memory region </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>size of memory region </td></tr>
  </table>
</dl>

<p>Referenced by <a class="el" href="taintcheck_8c-source.html#l00198">__attribute__()</a>.</p>

</div>
</div><p>
<a class="anchor" name="738038bc4fd5a2ab5399a878886a6e63"></a><!-- doxytag: member="plugin_interface_t::memreg_eip_change" ref="738038bc4fd5a2ab5399a878886a6e63" args=")()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structplugin__interface__t.html#738038bc4fd5a2ab5399a878886a6e63">plugin_interface_t::memreg_eip_change</a>)()          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="taintcheck_8c-source.html#l01477">taintcheck_check_eip()</a>.</p>

</div>
</div><p>
<a class="anchor" name="60b5ab751ae4d15984244a780929a2d9"></a><!-- doxytag: member="plugin_interface_t::monitored_cr3" ref="60b5ab751ae4d15984244a780929a2d9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t <a class="el" href="structplugin__interface__t.html#60b5ab751ae4d15984244a780929a2d9">plugin_interface_t::monitored_cr3</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
CR3 of a specified process to be monitored. 0 means system-wide monitoring, including all processes and kernel. 
<p>

<p>Definition at line <a class="el" href="TEMU__main_8h-source.html#l00371">371</a> of file <a class="el" href="TEMU__main_8h-source.html">TEMU_main.h</a>.</p>

<p>Referenced by <a class="el" href="TEMU__main_8c-source.html#l00541">TEMU_update_cr3()</a>.</p>

</div>
</div><p>
<a class="anchor" name="9f19c6d8662ab7784a598f729f951338"></a><!-- doxytag: member="plugin_interface_t::nic_recv" ref="9f19c6d8662ab7784a598f729f951338" args=")(uint8_t *buf, int size, int cur_pos, int start, int stop)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structplugin__interface__t.html#9f19c6d8662ab7784a598f729f951338">plugin_interface_t::nic_recv</a>)(uint8_t *buf, int <a class="el" href="taintcheck_8h.html#c5171f8c3bbd36e5425e886a5e20e790">size</a>, int cur_pos, int start, int stop)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This callback is invoked when a network packet is received by NIC. 
<p>

<p>Referenced by <a class="el" href="TEMU__main_8c-source.html#l00196">TEMU_nic_receive()</a>.</p>

</div>
</div><p>
<a class="anchor" name="461e4e6270fd31ef6c4fa6e076f69dab"></a><!-- doxytag: member="plugin_interface_t::nic_send" ref="461e4e6270fd31ef6c4fa6e076f69dab" args=")(uint32_t addr, int size, uint8_t *buf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structplugin__interface__t.html#461e4e6270fd31ef6c4fa6e076f69dab">plugin_interface_t::nic_send</a>)(uint32_t addr, int <a class="el" href="taintcheck_8h.html#c5171f8c3bbd36e5425e886a5e20e790">size</a>, uint8_t *buf)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This callback is invoked when a network packet is sent out by NIC. 
<p>

<p>Referenced by <a class="el" href="TEMU__main_8c-source.html#l00204">TEMU_nic_send()</a>.</p>

</div>
</div><p>
<a class="anchor" name="893b0321029bbf4619a76d719486ff27"></a><!-- doxytag: member="plugin_interface_t::plugin_cleanup" ref="893b0321029bbf4619a76d719486ff27" args=")()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structplugin__interface__t.html#893b0321029bbf4619a76d719486ff27">plugin_interface_t::plugin_cleanup</a>)()          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
callback for cleaning up states in plugin. TEMU plugin must release all allocated resources in this function 
<p>

<p>Referenced by <a class="el" href="TEMU__main_8c-source.html#l00136">do_unload_plugin()</a>.</p>

</div>
</div><p>
<a class="anchor" name="655dd7f42359c9e4fc0c00186492d4ba"></a><!-- doxytag: member="plugin_interface_t::pre_mem_write" ref="655dd7f42359c9e4fc0c00186492d4ba" args=")(uint32_t virt_addr, uint32_t phys_addr, int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structplugin__interface__t.html#655dd7f42359c9e4fc0c00186492d4ba">plugin_interface_t::pre_mem_write</a>)(uint32_t virt_addr, uint32_t phys_addr, int <a class="el" href="taintcheck_8h.html#c5171f8c3bbd36e5425e886a5e20e790">size</a>)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="taintcheck_8c-source.html#l00198">__attribute__()</a>.</p>

</div>
</div><p>
<a class="anchor" name="83d37405cce213c4766e1bfbe6f9813a"></a><!-- doxytag: member="plugin_interface_t::read_disk_taint" ref="83d37405cce213c4766e1bfbe6f9813a" args=")(uint64_t addr, uint8_t *record, void *opaque)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structplugin__interface__t.html#83d37405cce213c4766e1bfbe6f9813a">plugin_interface_t::read_disk_taint</a>)(uint64_t addr, uint8_t *record, void *opaque)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="taintcheck_8c-source.html#l01076">taintcheck_chk_hdin()</a>, and <a class="el" href="taintcheck_8c-source.html#l01144">taintcheck_chk_hdread()</a>.</p>

</div>
</div><p>
<a class="anchor" name="f9db66146dd22bdad23b09bf2f013a6d"></a><!-- doxytag: member="plugin_interface_t::reg_read" ref="f9db66146dd22bdad23b09bf2f013a6d" args=")(uint32_t regidx, int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structplugin__interface__t.html#f9db66146dd22bdad23b09bf2f013a6d">plugin_interface_t::reg_read</a>)(uint32_t regidx, int <a class="el" href="taintcheck_8h.html#c5171f8c3bbd36e5425e886a5e20e790">size</a>)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This callback is invoked when the current instruction reads a register. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>regidx</em>&nbsp;</td><td>register index, e.g., the index of R_BH is R_EBX*4 + 1 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>size of register in bytes </td></tr>
  </table>
</dl>

<p>Referenced by <a class="el" href="taintcheck_8c-source.html#l00198">__attribute__()</a>.</p>

</div>
</div><p>
<a class="anchor" name="80ee4e68586dbf9579df2f774001b01b"></a><!-- doxytag: member="plugin_interface_t::reg_write" ref="80ee4e68586dbf9579df2f774001b01b" args=")(uint32_t regidx, int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structplugin__interface__t.html#80ee4e68586dbf9579df2f774001b01b">plugin_interface_t::reg_write</a>)(uint32_t regidx, int <a class="el" href="taintcheck_8h.html#c5171f8c3bbd36e5425e886a5e20e790">size</a>)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This callback is invoked when the current instruction writes a register. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>regidx</em>&nbsp;</td><td>register index, e.g., the index of R_BH is R_EBX*4 + 1 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>size of register in bytes </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="4cca549b7f2c09fa47d356115741dd78"></a><!-- doxytag: member="plugin_interface_t::send_keystroke" ref="4cca549b7f2c09fa47d356115741dd78" args=")(int reg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structplugin__interface__t.html#4cca549b7f2c09fa47d356115741dd78">plugin_interface_t::send_keystroke</a>)(int reg)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="TEMU__main_8c-source.html#l00235">TEMU_read_keystroke()</a>.</p>

</div>
</div><p>
<a class="anchor" name="7f646c69e77b630c1cda6f206ca125d6"></a><!-- doxytag: member="plugin_interface_t::taint_disk" ref="7f646c69e77b630c1cda6f206ca125d6" args=")(uint64_t addr, uint8_t *record, void *opaque)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structplugin__interface__t.html#7f646c69e77b630c1cda6f206ca125d6">plugin_interface_t::taint_disk</a>)(uint64_t addr, uint8_t *record, void *opaque)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="taintcheck_8c-source.html#l01048">taintcheck_chk_hdout()</a>, and <a class="el" href="taintcheck_8c-source.html#l01115">taintcheck_chk_hdwrite()</a>.</p>

</div>
</div><p>
<a class="anchor" name="9d9c6f38a85ffe4738755a465115c94f"></a><!-- doxytag: member="plugin_interface_t::taint_propagate" ref="9d9c6f38a85ffe4738755a465115c94f" args=")(int nr_src, taint_operand_t *src_oprnds, taint_operand_t *dst_oprnd, int mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="structplugin__interface__t.html#9d9c6f38a85ffe4738755a465115c94f">plugin_interface_t::taint_propagate</a>)(int nr_src, <a class="el" href="structtaint__operand__t.html">taint_operand_t</a> *src_oprnds, <a class="el" href="structtaint__operand__t.html">taint_operand_t</a> *dst_oprnd, int mode)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This callback customizes its own policy for taint propagation. 
<p>
TEMU asks plugin how to propagate tainted data. If the plugin does not want to customize the propagation policy, it can simply specify <a class="el" href="group__taintcheck.html#gf9411e493b746336120fb58c3449135a">default_taint_propagate()</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>nr_src</em>&nbsp;</td><td>number of source operands </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>src_oprnds</em>&nbsp;</td><td>array of source operands </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dst_oprnd</em>&nbsp;</td><td>destination operand </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mode</em>&nbsp;</td><td>mode of propagation (either direct move or transformation) </td></tr>
  </table>
</dl>

<p>Referenced by <a class="el" href="taintcheck_8c-source.html#l00198">__attribute__()</a>, and <a class="el" href="taintcheck_8c-source.html#l00475">reg2reg_internal()</a>.</p>

</div>
</div><p>
<a class="anchor" name="cf6b2847bc302d9e0c94ca21fd81a75d"></a><!-- doxytag: member="plugin_interface_t::taint_record_size" ref="cf6b2847bc302d9e0c94ca21fd81a75d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="structplugin__interface__t.html#cf6b2847bc302d9e0c94ca21fd81a75d">plugin_interface_t::taint_record_size</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
size of taint record for each tainted byte. TEMU sees taint record as untyped buffer, so it only cares about the size of taint record 
<p>

<p>Definition at line <a class="el" href="TEMU__main_8h-source.html#l00307">307</a> of file <a class="el" href="TEMU__main_8h-source.html">TEMU_main.h</a>.</p>

<p>Referenced by <a class="el" href="taintcheck_8c-source.html#l00198">__attribute__()</a>, <a class="el" href="taintcheck_8c-source.html#l01755">default_taint_propagate()</a>, <a class="el" href="taintcheck_8c-source.html#l00130">fast_clean_memory()</a>, <a class="el" href="taintcheck_8c-source.html#l00091">fast_taint_memory()</a>, <a class="el" href="taintcheck_8c-source.html#l00943">LIST_HEAD()</a>, <a class="el" href="taintcheck_8c-source.html#l00475">reg2reg_internal()</a>, <a class="el" href="taintcheck_8c-source.html#l01477">taintcheck_check_eip()</a>, <a class="el" href="taintcheck_8c-source.html#l01432">taintcheck_check_virtmem()</a>, <a class="el" href="taintcheck_8c-source.html#l01076">taintcheck_chk_hdin()</a>, <a class="el" href="taintcheck_8c-source.html#l01048">taintcheck_chk_hdout()</a>, <a class="el" href="taintcheck_8c-source.html#l01144">taintcheck_chk_hdread()</a>, <a class="el" href="taintcheck_8c-source.html#l01115">taintcheck_chk_hdwrite()</a>, <a class="el" href="taintcheck_8c-source.html#l01593">taintcheck_create()</a>, <a class="el" href="taintcheck_8c-source.html#l01010">taintcheck_disk_check()</a>, <a class="el" href="taintcheck_8c-source.html#l01541">taintcheck_load()</a>, <a class="el" href="taintcheck_8c-source.html#l01316">taintcheck_memory_check()</a>, <a class="el" href="taintcheck_8c-source.html#l01275">taintcheck_nic_in()</a>, <a class="el" href="taintcheck_8c-source.html#l01263">taintcheck_nic_out()</a>, <a class="el" href="taintcheck_8c-source.html#l01238">taintcheck_nic_readbuf()</a>, <a class="el" href="taintcheck_8c-source.html#l01213">taintcheck_nic_writebuf()</a>, <a class="el" href="taintcheck_8c-source.html#l01344">taintcheck_register_check()</a>, <a class="el" href="taintcheck_8c-source.html#l01508">taintcheck_save()</a>, <a class="el" href="taintcheck_8c-source.html#l01380">taintcheck_taint_memory()</a>, <a class="el" href="taintcheck_8c-source.html#l01359">taintcheck_taint_register()</a>, and <a class="el" href="taintcheck_8c-source.html#l01406">taintcheck_taint_virtmem()</a>.</p>

</div>
</div><p>
<a class="anchor" name="9d8d8731debe4e3f0e17bc9124f0d2ad"></a><!-- doxytag: member="plugin_interface_t::term_cmds" ref="9d8d8731debe4e3f0e17bc9124f0d2ad" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structterm__cmd__t.html">term_cmd_t</a>* <a class="el" href="structplugin__interface__t.html#9d8d8731debe4e3f0e17bc9124f0d2ad">plugin_interface_t::term_cmds</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
array of terminal commands 
<p>

<p>Definition at line <a class="el" href="TEMU__main_8h-source.html#l00295">295</a> of file <a class="el" href="TEMU__main_8h-source.html">TEMU_main.h</a>.</p>

</div>
</div><p>
<hr>The documentation for this struct was generated from the following file:<ul>
<li><a class="el" href="TEMU__main_8h-source.html">TEMU_main.h</a></ul>
</div>
<hr>
<p class="footer">
Generated on Fri Mar 30 16:18:26 2012 for <a href="http://bitblaze.cs.berkeley.edu/temu.html">TEMU</a> by
<a href="http://www.doxygen.org"><img src="doxygen.png" alt="Doxygen"
align="middle" border="0"/>1.5.8</a><br/>
Copyright &copy; 2008-2009, BitBlaze Project. All Rights Reserved.</p>

<hr>
<!--#include virtual="/attrib.incl" -->

</body>
</html>
