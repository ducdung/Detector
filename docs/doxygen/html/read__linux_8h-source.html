<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="keywords" content="TEMU, dynamic analysis, binary analysis, dynamic
taint analysis"/>
<meta name="description" content="C/C++/OCaml Source Code Documentation for the TEMU Project."/>
<title>TEMU: read_linux.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head><body>
<p class="title">TEMU: Dynamic Binary Analysis Platform</p>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_4f22f3fd3d3cce94a331ff7cdf0bf085.html">temu-1.0</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_3b6767f6be6ef802b0654406f3e74d86.html">shared</a>
  </div>
</div>
<div class="contents">
<h1>read_linux.h</h1><a href="read__linux_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment">TEMU is Copyright (C) 2006-2009, BitBlaze Team.</span>
<a name="l00003"></a>00003 <span class="comment"></span>
<a name="l00004"></a>00004 <span class="comment">TEMU is based on QEMU, a whole-system emulator. You can redistribute</span>
<a name="l00005"></a>00005 <span class="comment">and modify it under the terms of the GNU LGPL, version 2.1 or later,</span>
<a name="l00006"></a>00006 <span class="comment">but it is made available WITHOUT ANY WARRANTY. See the top-level</span>
<a name="l00007"></a>00007 <span class="comment">README file for more details.</span>
<a name="l00008"></a>00008 <span class="comment"></span>
<a name="l00009"></a>00009 <span class="comment">For more information about TEMU and other BitBlaze software, see our</span>
<a name="l00010"></a>00010 <span class="comment">web site at: http://bitblaze.cs.berkeley.edu/</span>
<a name="l00011"></a>00011 <span class="comment">*/</span>
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="preprocessor">#ifndef __READ_LINUX_H__</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span><span class="preprocessor">#define __READ_LINUX_H__</span>
<a name="l00015"></a>00015 <span class="preprocessor"></span><span class="preprocessor">#include "<a class="code" href="hookapi_8h.html">hookapi.h</a>"</span>
<a name="l00016"></a>00016 
<a name="l00017"></a><a class="code" href="structkoffset.html">00017</a> <span class="keyword">struct </span><a class="code" href="structkoffset.html">koffset</a> {
<a name="l00018"></a><a class="code" href="structkoffset.html#329ae041a1cf35c34b0d59e8a5165d9e">00018</a>     <span class="keywordtype">char</span> <a class="code" href="structkoffset.html#329ae041a1cf35c34b0d59e8a5165d9e">version</a>[128]; 
<a name="l00019"></a><a class="code" href="structkoffset.html#b20cd1b586b0dfcc0d0f41f92894d3be">00019</a>     target_ulong <a class="code" href="structkoffset.html#b20cd1b586b0dfcc0d0f41f92894d3be">hookingpoint</a>;
<a name="l00020"></a><a class="code" href="structkoffset.html#48b75d2bee3bb598b6bcc109856a1b6b">00020</a>     target_ulong <a class="code" href="structkoffset.html#48b75d2bee3bb598b6bcc109856a1b6b">hookingpoint2</a>; 
<a name="l00021"></a><a class="code" href="structkoffset.html#b39241b30f64f6b416b55dd464098b14">00021</a>     target_ulong <a class="code" href="structkoffset.html#b39241b30f64f6b416b55dd464098b14">taskaddr</a>; 
<a name="l00022"></a><a class="code" href="structkoffset.html#7ec6ffedd426b9a495e3c25b7451a44e">00022</a>     <span class="keywordtype">int</span> <a class="code" href="structkoffset.html#7ec6ffedd426b9a495e3c25b7451a44e">tasksize</a>; 
<a name="l00023"></a><a class="code" href="structkoffset.html#49565bcc32239a3401a34f302adb03ae">00023</a>     <span class="keywordtype">int</span> <a class="code" href="structkoffset.html#49565bcc32239a3401a34f302adb03ae">listoffset</a>; 
<a name="l00024"></a><a class="code" href="structkoffset.html#cb7d98076b0bb0a2597e985271fed3d8">00024</a>     <span class="keywordtype">int</span> <a class="code" href="structkoffset.html#cb7d98076b0bb0a2597e985271fed3d8">pidoffset</a>; 
<a name="l00025"></a><a class="code" href="structkoffset.html#adef801f42edc86d44e39be49bdfb56b">00025</a>     <span class="keywordtype">int</span> <a class="code" href="structkoffset.html#adef801f42edc86d44e39be49bdfb56b">mmoffset</a>; 
<a name="l00026"></a><a class="code" href="structkoffset.html#948c79bee6801a6c0fd84852d495947c">00026</a>     <span class="keywordtype">int</span> <a class="code" href="structkoffset.html#948c79bee6801a6c0fd84852d495947c">pgdoffset</a>; 
<a name="l00027"></a><a class="code" href="structkoffset.html#c3a82d29f9e4931227c01a8bfbf49233">00027</a>     <span class="keywordtype">int</span> <a class="code" href="structkoffset.html#c3a82d29f9e4931227c01a8bfbf49233">commoffset</a>; 
<a name="l00028"></a><a class="code" href="structkoffset.html#2d031b15bd9eca2e9369fd8a1bdda0e6">00028</a>     <span class="keywordtype">int</span> <a class="code" href="structkoffset.html#2d031b15bd9eca2e9369fd8a1bdda0e6">commsize</a>; 
<a name="l00029"></a><a class="code" href="structkoffset.html#59abe34a04b7648651c485afeb691643">00029</a>     <span class="keywordtype">int</span> <a class="code" href="structkoffset.html#59abe34a04b7648651c485afeb691643">vmstartoffset</a>; 
<a name="l00030"></a><a class="code" href="structkoffset.html#e1f09c16242160d13eb39d1873eca7ac">00030</a>     <span class="keywordtype">int</span> <a class="code" href="structkoffset.html#e1f09c16242160d13eb39d1873eca7ac">vmendoffset</a>;
<a name="l00031"></a><a class="code" href="structkoffset.html#6fdef5531a618faa643796d98d855eb5">00031</a>     <span class="keywordtype">int</span> <a class="code" href="structkoffset.html#6fdef5531a618faa643796d98d855eb5">vmnextoffset</a>; 
<a name="l00032"></a><a class="code" href="structkoffset.html#87197745a3d17435c6655c8c862385b7">00032</a>     <span class="keywordtype">int</span> <a class="code" href="structkoffset.html#87197745a3d17435c6655c8c862385b7">vmfileoffset</a>; 
<a name="l00033"></a><a class="code" href="structkoffset.html#5180311a79fa59ab8aa60e3a1ef91aee">00033</a>     <span class="keywordtype">int</span> <a class="code" href="structkoffset.html#5180311a79fa59ab8aa60e3a1ef91aee">dentryoffset</a>; 
<a name="l00034"></a><a class="code" href="structkoffset.html#f575d46f9f5524fd5cab12921aaf64b4">00034</a>     <span class="keywordtype">int</span> <a class="code" href="structkoffset.html#f575d46f9f5524fd5cab12921aaf64b4">dnameoffset</a>; 
<a name="l00035"></a><a class="code" href="structkoffset.html#36537185c663a5ec3719d307c8c28cd1">00035</a>     <span class="keywordtype">int</span> <a class="code" href="structkoffset.html#36537185c663a5ec3719d307c8c28cd1">dinameoffset</a>; 
<a name="l00036"></a>00036 }; 
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 <span class="keyword">extern</span> target_ulong <a class="code" href="read__linux_8c.html#7aff3dbfe45ded1438505f941d66feeb">kernel_mem_start</a>; 
<a name="l00039"></a>00039 <span class="keyword">extern</span> target_ulong <a class="code" href="read__linux_8c.html#cf19b09e7312ce1667e2638e381867cb">hookingpoint</a>;
<a name="l00040"></a>00040 <span class="keyword">extern</span> target_ulong <a class="code" href="read__linux_8c.html#cfa98d2760c625a014488c032c98b09b">hookingpoint2</a>;
<a name="l00041"></a>00041 <span class="keyword">extern</span> target_ulong <a class="code" href="read__linux_8c.html#0a9abf350f3fe8dc663bf3b46b1f9af6">taskaddr</a>; 
<a name="l00042"></a>00042 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="read__linux_8c.html#10410bbd38375affc44ef92e9093fe53">tasksize</a>; 
<a name="l00043"></a>00043 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="read__linux_8c.html#fb087359463cc239f7a8aa571d1c4338">listoffset</a>; 
<a name="l00044"></a>00044 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="read__linux_8c.html#ccb3480735ebf94671f7a804ca5580c1">pidoffset</a>; 
<a name="l00045"></a>00045 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="read__linux_8c.html#45ac4e1bc29fbd48f1fe5f68816735ed">mmoffset</a>; 
<a name="l00046"></a>00046 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="read__linux_8c.html#85e0cfb4010cada410b2f7323ed5130d">pgdoffset</a>; 
<a name="l00047"></a>00047 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="read__linux_8c.html#3dc8f15cda87155dcf78541489e87613">commoffset</a>; 
<a name="l00048"></a>00048 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="read__linux_8c.html#58075e4627bf927969346f91c58cdbc8">commsize</a>; 
<a name="l00049"></a>00049 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="read__linux_8c.html#c59d239f8f3d479b60bc66b98fec6f6c">vmstartoffset</a>; 
<a name="l00050"></a>00050 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="read__linux_8c.html#a15a4fb44902511ef277f51cd18bf459">vmendoffset</a>; 
<a name="l00051"></a>00051 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="read__linux_8c.html#8bcaa5faf0cafc06005e581c99d935d6">vmnextoffset</a>; 
<a name="l00052"></a>00052 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="read__linux_8c.html#69d316f01ddf7b9c9fb94b97cba7918d">vmfileoffset</a>; 
<a name="l00053"></a>00053 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="read__linux_8c.html#0249d3d23e5faa66ce5f2600b36145eb">dentryoffset</a>; 
<a name="l00054"></a>00054 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="read__linux_8c.html#80455c6c576d3984d8c4503fec6abb69">dnameoffset</a>; 
<a name="l00055"></a>00055 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="read__linux_8c.html#3bc76dc8fb40a83c0a5c1f1dce543bf7">dinameoffset</a>; 
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 <span class="comment">/* offset for fc5 image </span>
<a name="l00059"></a>00059 <span class="comment">static const long hookingpoint = 0xC01A26FC; // selinux_...</span>
<a name="l00060"></a>00060 <span class="comment">static const long taskaddr = 0xC033C300; </span>
<a name="l00061"></a>00061 <span class="comment">static const int tasksize = 1360; </span>
<a name="l00062"></a>00062 <span class="comment">static const int listoffset = 96; </span>
<a name="l00063"></a>00063 <span class="comment">static const int pidoffset = 156; </span>
<a name="l00064"></a>00064 <span class="comment">static const int mmoffset = 120; </span>
<a name="l00065"></a>00065 <span class="comment">static const int pgdoffset = 40; </span>
<a name="l00066"></a>00066 <span class="comment">static const int commoffset = 432; </span>
<a name="l00067"></a>00067 <span class="comment">static const int commsize = 16; </span>
<a name="l00068"></a>00068 <span class="comment"></span>
<a name="l00069"></a>00069 <span class="comment">static const int vmfileoffset = 76; </span>
<a name="l00070"></a>00070 <span class="comment">static const int dentryoffset = 8; </span>
<a name="l00071"></a>00071 <span class="comment">static const int dnameoffset = 40; </span>
<a name="l00072"></a>00072 <span class="comment">static const int dinameoffset = 112; */</span>
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 <span class="comment">/* offset for redhat 7.3 */</span>
<a name="l00075"></a>00075 <span class="comment">/* static const long hookingpoint = 0xC0117140; </span>
<a name="l00076"></a>00076 <span class="comment">static const long taskaddr = 0xC031E000; </span>
<a name="l00077"></a>00077 <span class="comment">static const int tasksize = 1424; </span>
<a name="l00078"></a>00078 <span class="comment">static const int listoffset = 72; </span>
<a name="l00079"></a>00079 <span class="comment">static const int pidoffset = 108; </span>
<a name="l00080"></a>00080 <span class="comment">static const int mmoffset = 44; </span>
<a name="l00081"></a>00081 <span class="comment">static const int pgdoffset = 12; </span>
<a name="l00082"></a>00082 <span class="comment">static const int commoffset = 558; </span>
<a name="l00083"></a>00083 <span class="comment">static const int commsize = 16; </span>
<a name="l00084"></a>00084 <span class="comment"></span>
<a name="l00085"></a>00085 <span class="comment">static const int vmfileoffset = 56; </span>
<a name="l00086"></a>00086 <span class="comment">static const int dentryoffset = 8; </span>
<a name="l00087"></a>00087 <span class="comment">static const int dnameoffset = 60; </span>
<a name="l00088"></a>00088 <span class="comment">static const int dinameoffset = 96;  */</span>
<a name="l00089"></a>00089 
<a name="l00090"></a>00090 
<a name="l00091"></a>00091 <span class="keywordtype">int</span> <a class="code" href="read__linux_8h.html#d54a49a77b96c6db2cbc3e9428adcd21">get_data</a>(target_ulong addr, <span class="keywordtype">void</span> *target, <span class="keywordtype">int</span> <a class="code" href="taintcheck_8h.html#c5171f8c3bbd36e5425e886a5e20e790">size</a>); 
<a name="l00092"></a>00092 target_ulong <a class="code" href="read__linux_8c.html#15d75926e261b4db52f37b8804164f94">next_task_struct</a>(target_ulong addr); 
<a name="l00093"></a>00093 target_ulong <a class="code" href="read__linux_8c.html#f1dda0a7d3e52bc73063b338a6a6657a">get_pid</a>(target_ulong addr); 
<a name="l00094"></a>00094 target_ulong <a class="code" href="read__linux_8c.html#0ebf8a6003e53cfee2964df26f64e026">get_pgd</a>(target_ulong addr);
<a name="l00095"></a>00095 <span class="keywordtype">void</span> <a class="code" href="read__linux_8c.html#99581107ebf958a3b71b67a2df4a942d">get_name</a>(target_ulong addr, <span class="keywordtype">char</span> *buf, <span class="keywordtype">int</span> <a class="code" href="taintcheck_8h.html#c5171f8c3bbd36e5425e886a5e20e790">size</a>);
<a name="l00096"></a>00096 target_ulong <a class="code" href="read__linux_8c.html#c5ad2377fdbb13dd2e2e12b6997e186e">get_first_mmap</a>(target_ulong addr);
<a name="l00097"></a>00097 target_ulong <a class="code" href="read__linux_8c.html#73b8e950f5f685f3fd768ddee7e1f05e">get_next_mmap</a>(target_ulong addr);
<a name="l00098"></a>00098 target_ulong <a class="code" href="read__linux_8c.html#c8ab0d9e6c02fe9d205c4633fb03d27e">get_vmstart</a>(target_ulong addr);
<a name="l00099"></a>00099 target_ulong <a class="code" href="read__linux_8c.html#ae6e4d30e2f70f0f43e69964294c9a05">get_vmend</a>(target_ulong addr);
<a name="l00100"></a>00100 <span class="keywordtype">void</span> <a class="code" href="read__linux_8c.html#cf8579a296bb57713b4ea0f5b9411b8b">get_mod_name</a>(target_ulong addr, <span class="keywordtype">char</span> *name, <span class="keywordtype">int</span> <a class="code" href="taintcheck_8h.html#c5171f8c3bbd36e5425e886a5e20e790">size</a>);
<a name="l00101"></a>00101 <span class="keywordtype">int</span> <a class="code" href="read__linux_8c.html#be6f15e0f4742000691ccfb26fe543de">init_kernel_offsets</a>();
<a name="l00102"></a>00102 
<a name="l00103"></a>00103 <span class="keywordtype">void</span> <a class="code" href="read__linux_8c.html#d5ec06b6fefbe48e582508c6993b0522">for_all_hookpoints</a>(<a class="code" href="hookapi_8h.html#2e3871d1647a63d42c2b0ace7dcc3c94">hook_proc_t</a> func, <span class="keywordtype">int</span> action);
<a name="l00104"></a>00104 <span class="preprocessor">#endif</span>
</pre></div></div>
<hr>
<p class="footer">
Generated on Fri Mar 30 16:18:24 2012 for <a href="http://bitblaze.cs.berkeley.edu/temu.html">TEMU</a> by
<a href="http://www.doxygen.org"><img src="doxygen.png" alt="Doxygen"
align="middle" border="0"/>1.5.8</a><br/>
Copyright &copy; 2008-2009, BitBlaze Project. All Rights Reserved.</p>

<hr>
<!--#include virtual="/attrib.incl" -->

</body>
</html>
