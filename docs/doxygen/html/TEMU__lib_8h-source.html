<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="keywords" content="TEMU, dynamic analysis, binary analysis, dynamic
taint analysis"/>
<meta name="description" content="C/C++/OCaml Source Code Documentation for the TEMU Project."/>
<title>TEMU: TEMU_lib.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head><body>
<p class="title">TEMU: Dynamic Binary Analysis Platform</p>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_4f22f3fd3d3cce94a331ff7cdf0bf085.html">temu-1.0</a>
  </div>
</div>
<div class="contents">
<h1>TEMU_lib.h</h1><a href="TEMU__lib_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment">TEMU is Copyright (C) 2006-2009, BitBlaze Team.</span>
<a name="l00003"></a>00003 <span class="comment"></span>
<a name="l00004"></a>00004 <span class="comment">TEMU is based on QEMU, a whole-system emulator. You can redistribute</span>
<a name="l00005"></a>00005 <span class="comment">and modify it under the terms of the GNU LGPL, version 2.1 or later,</span>
<a name="l00006"></a>00006 <span class="comment">but it is made available WITHOUT ANY WARRANTY. See the top-level</span>
<a name="l00007"></a>00007 <span class="comment">README file for more details.</span>
<a name="l00008"></a>00008 <span class="comment"></span>
<a name="l00009"></a>00009 <span class="comment">For more information about TEMU and other BitBlaze software, see our</span>
<a name="l00010"></a>00010 <span class="comment">web site at: http://bitblaze.cs.berkeley.edu/</span>
<a name="l00011"></a>00011 <span class="comment">*/</span>
<a name="l00012"></a>00012 <span class="comment"></span>
<a name="l00013"></a>00013 <span class="comment">/// @file TEMU_lib.h</span>
<a name="l00014"></a>00014 <span class="comment">/// @author: Heng Yin &lt;hyin@ece.cmu.edu&gt;</span>
<a name="l00015"></a>00015 <span class="comment"></span>
<a name="l00016"></a>00016 <span class="preprocessor">#ifndef TEMU_LIB_H_INCLUDED</span>
<a name="l00017"></a>00017 <span class="preprocessor"></span><span class="preprocessor">#define TEMU_LIB_H_INCLUDED</span>
<a name="l00018"></a>00018 <span class="preprocessor"></span>
<a name="l00019"></a>00019 <span class="preprocessor">#include "<a class="code" href="TEMU__main_8h.html">TEMU_main.h</a>"</span>
<a name="l00020"></a>00020 
<a name="l00021"></a>00021 <span class="comment">/**** QEMU Timer ****/</span>
<a name="l00022"></a><a class="code" href="TEMU__lib_8h.html#538feacecae8cbd171986cf20c140bb8">00022</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="TEMU__lib_8h.html#538feacecae8cbd171986cf20c140bb8">QEMUClock</a> <a class="code" href="TEMU__lib_8h.html#538feacecae8cbd171986cf20c140bb8">QEMUClock</a>;
<a name="l00023"></a><a class="code" href="TEMU__lib_8h.html#fdf24f547cf47b886d1b3b11ae458cad">00023</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="TEMU__lib_8h.html#fdf24f547cf47b886d1b3b11ae458cad">QEMUTimer</a> <a class="code" href="TEMU__lib_8h.html#fdf24f547cf47b886d1b3b11ae458cad">QEMUTimer</a>;
<a name="l00024"></a><a class="code" href="TEMU__lib_8h.html#603a2daa82bf3d10f4f662bbe7647235">00024</a> <span class="keyword">typedef</span> <span class="keywordtype">void</span> <a class="code" href="TEMU__lib_8h.html#603a2daa82bf3d10f4f662bbe7647235">QEMUTimerCB</a>(<span class="keywordtype">void</span> *opaque);
<a name="l00025"></a>00025 int64_t <a class="code" href="TEMU__lib_8h.html#ab0c8d91c8774ff37ae33d9f29bbe0fd">qemu_get_clock</a>(<a class="code" href="TEMU__lib_8h.html#538feacecae8cbd171986cf20c140bb8">QEMUClock</a> *clock);
<a name="l00026"></a>00026 <span class="keyword">extern</span> <a class="code" href="TEMU__lib_8h.html#538feacecae8cbd171986cf20c140bb8">QEMUClock</a> *<a class="code" href="TEMU__lib_8h.html#db9f6f43d59d3c8e1caa3b9cd769a579">vm_clock</a>;
<a name="l00027"></a>00027 <span class="keyword">extern</span> int64_t <a class="code" href="TEMU__lib_8h.html#e870f72e3bd7a47d6ca5796036ca3cf0">ticks_per_sec</a>;
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="comment">/**** Page Definitions ****/</span>
<a name="l00030"></a>00030 <span class="preprocessor">#define TARGET_PAGE_BITS 12</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span><span class="preprocessor">#define TARGET_PAGE_SIZE (1 &lt;&lt; TARGET_PAGE_BITS)</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span><span class="preprocessor">#define TARGET_PAGE_MASK ~(TARGET_PAGE_SIZE - 1)</span>
<a name="l00033"></a>00033 <span class="preprocessor"></span>
<a name="l00034"></a>00034 <span class="comment">/**** QEMU VM Load/Save ******/</span>
<a name="l00035"></a><a class="code" href="TEMU__lib_8h.html#652d9ff75e9a5ca7a6667335be7755f7">00035</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="TEMU__lib_8h.html#652d9ff75e9a5ca7a6667335be7755f7">QEMUFile</a> <a class="code" href="TEMU__lib_8h.html#652d9ff75e9a5ca7a6667335be7755f7">QEMUFile</a>;
<a name="l00036"></a>00036 <a class="code" href="TEMU__lib_8h.html#652d9ff75e9a5ca7a6667335be7755f7">QEMUFile</a> *<a class="code" href="TEMU__lib_8h.html#984a53e6428ceda90f50a824f28302d1">qemu_fopen</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *filename, <span class="keyword">const</span> <span class="keywordtype">char</span> *mode);
<a name="l00037"></a>00037 <span class="keywordtype">void</span> <a class="code" href="TEMU__lib_8h.html#4ff989e53d508a23bc528e52e8adb011">qemu_fflush</a>(<a class="code" href="TEMU__lib_8h.html#652d9ff75e9a5ca7a6667335be7755f7">QEMUFile</a> *f);
<a name="l00038"></a>00038 <span class="keywordtype">void</span> <a class="code" href="TEMU__lib_8h.html#b559a9dac78fd44e39e7b243d02703c6">qemu_fclose</a>(<a class="code" href="TEMU__lib_8h.html#652d9ff75e9a5ca7a6667335be7755f7">QEMUFile</a> *f);
<a name="l00039"></a>00039 <span class="keywordtype">void</span> <a class="code" href="TEMU__lib_8h.html#bab97910b84b56c8e39acace6be4578a">qemu_put_buffer</a>(<a class="code" href="TEMU__lib_8h.html#652d9ff75e9a5ca7a6667335be7755f7">QEMUFile</a> *f, <span class="keyword">const</span> uint8_t *buf, <span class="keywordtype">int</span> <a class="code" href="taintcheck_8h.html#c5171f8c3bbd36e5425e886a5e20e790">size</a>);
<a name="l00040"></a>00040 <span class="keywordtype">void</span> <a class="code" href="TEMU__lib_8h.html#3500934655288fcef599b8e4f26b1e8e">qemu_put_byte</a>(<a class="code" href="TEMU__lib_8h.html#652d9ff75e9a5ca7a6667335be7755f7">QEMUFile</a> *f, <span class="keywordtype">int</span> v);
<a name="l00041"></a>00041 <span class="keywordtype">void</span> <a class="code" href="TEMU__lib_8h.html#4e0614bbd79073c805df1832beed7cbe">qemu_put_be16</a>(<a class="code" href="TEMU__lib_8h.html#652d9ff75e9a5ca7a6667335be7755f7">QEMUFile</a> *f, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v);
<a name="l00042"></a>00042 <span class="keywordtype">void</span> <a class="code" href="TEMU__lib_8h.html#890dcce225bd20035e37663959c78dd3">qemu_put_be32</a>(<a class="code" href="TEMU__lib_8h.html#652d9ff75e9a5ca7a6667335be7755f7">QEMUFile</a> *f, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v);
<a name="l00043"></a>00043 <span class="keywordtype">void</span> <a class="code" href="TEMU__lib_8h.html#61c03b357724b1296bd49d78164b6508">qemu_put_be64</a>(<a class="code" href="TEMU__lib_8h.html#652d9ff75e9a5ca7a6667335be7755f7">QEMUFile</a> *f, uint64_t v);
<a name="l00044"></a>00044 <span class="keywordtype">int</span> <a class="code" href="TEMU__lib_8h.html#75e165529dd609aa13a21ce80bc80859">qemu_get_buffer</a>(<a class="code" href="TEMU__lib_8h.html#652d9ff75e9a5ca7a6667335be7755f7">QEMUFile</a> *f, uint8_t *buf, <span class="keywordtype">int</span> <a class="code" href="taintcheck_8h.html#c5171f8c3bbd36e5425e886a5e20e790">size</a>);
<a name="l00045"></a>00045 <span class="keywordtype">int</span> <a class="code" href="TEMU__lib_8h.html#98a4c1a5c6407cb8597420436d33e2b9">qemu_get_byte</a>(<a class="code" href="TEMU__lib_8h.html#652d9ff75e9a5ca7a6667335be7755f7">QEMUFile</a> *f);
<a name="l00046"></a>00046 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="TEMU__lib_8h.html#fe52f2c7f7eb3ff1fe39d1794d30cacb">qemu_get_be16</a>(<a class="code" href="TEMU__lib_8h.html#652d9ff75e9a5ca7a6667335be7755f7">QEMUFile</a> *f);
<a name="l00047"></a>00047 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="TEMU__lib_8h.html#ebe35a2af379d13c34a34a441b86a8f2">qemu_get_be32</a>(<a class="code" href="TEMU__lib_8h.html#652d9ff75e9a5ca7a6667335be7755f7">QEMUFile</a> *f);
<a name="l00048"></a>00048 uint64_t <a class="code" href="TEMU__lib_8h.html#c54730a70ad9761d67e81e8cd3e3d0c4">qemu_get_be64</a>(<a class="code" href="TEMU__lib_8h.html#652d9ff75e9a5ca7a6667335be7755f7">QEMUFile</a> *f);
<a name="l00049"></a><a class="code" href="TEMU__lib_8h.html#30f338947c9ce3fb0132ace248cb8957">00049</a> <span class="keyword">typedef</span> <span class="keywordtype">void</span> <a class="code" href="TEMU__lib_8h.html#30f338947c9ce3fb0132ace248cb8957">SaveStateHandler</a>(<a class="code" href="TEMU__lib_8h.html#652d9ff75e9a5ca7a6667335be7755f7">QEMUFile</a> *f, <span class="keywordtype">void</span> *opaque);
<a name="l00050"></a><a class="code" href="TEMU__lib_8h.html#3c4fc8c719a283606b691534ef4b230b">00050</a> <span class="keyword">typedef</span> <span class="keywordtype">int</span> <a class="code" href="TEMU__lib_8h.html#3c4fc8c719a283606b691534ef4b230b">LoadStateHandler</a>(<a class="code" href="TEMU__lib_8h.html#652d9ff75e9a5ca7a6667335be7755f7">QEMUFile</a> *f, <span class="keywordtype">void</span> *opaque, <span class="keywordtype">int</span> version_id);
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 
<a name="l00053"></a>00053 <span class="preprocessor">#define EXCP_INTERRUPT  0x10000 </span><span class="comment">/* async interruption */</span>
<a name="l00054"></a>00054 <span class="preprocessor">#define EXCP_HLT        0x10001 </span><span class="comment">/* hlt instruction reached */</span>
<a name="l00055"></a>00055 <span class="preprocessor">#define EXCP_DEBUG      0x10002 </span><span class="comment">/* cpu stopped after a breakpoint or singlestep */</span>
<a name="l00056"></a>00056 <span class="preprocessor">#define EXCP_HALTED     0x10003 </span><span class="comment">/* cpu is halted (waiting for external event) */</span>
<a name="l00057"></a>00057 <span class="comment"></span>
<a name="l00058"></a>00058 <span class="comment">/*! </span>
<a name="l00059"></a>00059 <span class="comment">  \addtogroup DEC  XED-DEC: XED Decoding instructions</span>
<a name="l00060"></a>00060 <span class="comment">  \addtogroup INIT XED-INIT: XED Initialization</span>
<a name="l00061"></a>00061 <span class="comment"></span>
<a name="l00062"></a>00062 <span class="comment">  \addtogroup main</span>
<a name="l00063"></a>00063 <span class="comment"> * Additional documentation for group 'main'</span>
<a name="l00064"></a>00064 <span class="comment"> * @{ </span>
<a name="l00065"></a>00065 <span class="comment"> */</span> <span class="comment">//start of group</span>
<a name="l00066"></a>00066 <span class="comment"></span>
<a name="l00067"></a>00067 <span class="comment">/// Create a timer</span>
<a name="l00068"></a>00068 <span class="comment"></span><a class="code" href="TEMU__lib_8h.html#fdf24f547cf47b886d1b3b11ae458cad">QEMUTimer</a> *<a class="code" href="group__main.html#gab6d1c3171ed4c9966a4bfe15104be32" title="Create a timer.">qemu_new_timer</a>(<a class="code" href="TEMU__lib_8h.html#538feacecae8cbd171986cf20c140bb8">QEMUClock</a> *clock, <a class="code" href="TEMU__lib_8h.html#603a2daa82bf3d10f4f662bbe7647235">QEMUTimerCB</a> *cb, <span class="keywordtype">void</span> *opaque);<span class="comment"></span>
<a name="l00069"></a>00069 <span class="comment">/// Free a timer</span>
<a name="l00070"></a>00070 <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="group__main.html#ga42bd66c56b34b4d9841845ad0218e69" title="Free a timer.">qemu_free_timer</a>(<a class="code" href="TEMU__lib_8h.html#fdf24f547cf47b886d1b3b11ae458cad">QEMUTimer</a> *ts);
<a name="l00071"></a>00071 <span class="keywordtype">void</span> <a class="code" href="group__main.html#gc1089439c67da848f57c20b9ebe3d807">qemu_del_timer</a>(<a class="code" href="TEMU__lib_8h.html#fdf24f547cf47b886d1b3b11ae458cad">QEMUTimer</a> *ts);<span class="comment"></span>
<a name="l00072"></a>00072 <span class="comment">/// Set up a timeout</span>
<a name="l00073"></a>00073 <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="group__main.html#gf1156c5fe506570112c128ad2deb7c6a" title="Set up a timeout.">qemu_mod_timer</a>(<a class="code" href="TEMU__lib_8h.html#fdf24f547cf47b886d1b3b11ae458cad">QEMUTimer</a> *ts, int64_t expire_time);<span class="comment"></span>
<a name="l00074"></a>00074 <span class="comment">/// Check if the timer is pending</span>
<a name="l00075"></a>00075 <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__main.html#gf4cbd4f35ccf112c62329a4e0c526059" title="Check if the timer is pending.">qemu_timer_pending</a>(<a class="code" href="TEMU__lib_8h.html#fdf24f547cf47b886d1b3b11ae458cad">QEMUTimer</a> *ts);
<a name="l00076"></a>00076 <span class="comment"></span>
<a name="l00077"></a>00077 <span class="comment">/// Register a VM entity for saving and restoring VM states</span>
<a name="l00078"></a>00078 <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__main.html#g655c4a0d124e52ec2188c6af01fd8362" title="Register a VM entity for saving and restoring VM states.">register_savevm</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *idstr, 
<a name="l00079"></a>00079                     <span class="keywordtype">int</span> instance_id, 
<a name="l00080"></a>00080                     <span class="keywordtype">int</span> version_id,
<a name="l00081"></a>00081                     <a class="code" href="TEMU__lib_8h.html#30f338947c9ce3fb0132ace248cb8957">SaveStateHandler</a> *save_state,
<a name="l00082"></a>00082                     <a class="code" href="TEMU__lib_8h.html#3c4fc8c719a283606b691534ef4b230b">LoadStateHandler</a> *load_state,
<a name="l00083"></a>00083                     <span class="keywordtype">void</span> *opaque);
<a name="l00084"></a>00084 <span class="comment"></span>
<a name="l00085"></a>00085 <span class="comment">/// Deregister a VM entity</span>
<a name="l00086"></a>00086 <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__main.html#g5fa8d036145c4828d8eb9b4a8e6a1edd" title="Deregister a VM entity.">deregister_savevm</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *idstr, <span class="keywordtype">int</span> instance_id);
<a name="l00087"></a>00087 <span class="comment"></span>
<a name="l00088"></a>00088 <span class="comment">/// Pause VM</span>
<a name="l00089"></a>00089 <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="group__main.html#g3ba811f15006cad963111f9d186faf62" title="Pause VM.">vm_stop</a>(<span class="keywordtype">int</span> reason);<span class="comment"></span>
<a name="l00090"></a>00090 <span class="comment">/// Load a previously saved VM snapshot</span>
<a name="l00091"></a>00091 <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="group__main.html#g6f0faa4e4bf7b162f0ad6e09a49a3b5f" title="Load a previously saved VM snapshot.">do_loadvm</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name);<span class="comment"></span>
<a name="l00092"></a>00092 <span class="comment">/// Save the current VM states into a snapshot</span>
<a name="l00093"></a>00093 <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="group__main.html#g76f0d4bf83716ad0d9344662ea051746" title="Save the current VM states into a snapshot.">do_savevm</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name);
<a name="l00094"></a>00094 
<a name="l00095"></a>00095 <span class="comment"></span>
<a name="l00096"></a>00096 <span class="comment">/// Send a keystroke</span>
<a name="l00097"></a>00097 <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="group__main.html#g2c3d0fd5734d74c0d41a362e164dc16f" title="Send a keystroke.">do_send_key</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">string</span>);<span class="comment"></span>
<a name="l00098"></a>00098 <span class="comment">/*! @} */</span> <span class="comment">//end of group</span>
<a name="l00099"></a>00099 
<a name="l00100"></a>00100 
<a name="l00101"></a>00101 
<a name="l00102"></a>00102 <span class="preprocessor">#endif //TEMU_LIB_H_INCLUDED</span>
</pre></div></div>
<hr>
<p class="footer">
Generated on Fri Mar 30 16:18:24 2012 for <a href="http://bitblaze.cs.berkeley.edu/temu.html">TEMU</a> by
<a href="http://www.doxygen.org"><img src="doxygen.png" alt="Doxygen"
align="middle" border="0"/>1.5.8</a><br/>
Copyright &copy; 2008-2009, BitBlaze Project. All Rights Reserved.</p>

<hr>
<!--#include virtual="/attrib.incl" -->

</body>
</html>
