<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="keywords" content="TEMU, dynamic analysis, binary analysis, dynamic
taint analysis"/>
<meta name="description" content="C/C++/OCaml Source Code Documentation for the TEMU Project."/>
<title>TEMU: disasm.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head><body>
<p class="title">TEMU: Dynamic Binary Analysis Platform</p>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_4f22f3fd3d3cce94a331ff7cdf0bf085.html">temu-1.0</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_3b6767f6be6ef802b0654406f3e74d86.html">shared</a>
  </div>
</div>
<div class="contents">
<h1>disasm.h</h1><a href="disasm_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment">TEMU is Copyright (C) 2006-2009, BitBlaze Team.</span>
<a name="l00003"></a>00003 <span class="comment"></span>
<a name="l00004"></a>00004 <span class="comment">TEMU is based on QEMU, a whole-system emulator. You can redistribute</span>
<a name="l00005"></a>00005 <span class="comment">and modify it under the terms of the GNU LGPL, version 2.1 or later,</span>
<a name="l00006"></a>00006 <span class="comment">but it is made available WITHOUT ANY WARRANTY. See the top-level</span>
<a name="l00007"></a>00007 <span class="comment">README file for more details.</span>
<a name="l00008"></a>00008 <span class="comment"></span>
<a name="l00009"></a>00009 <span class="comment">For more information about TEMU and other BitBlaze software, see our</span>
<a name="l00010"></a>00010 <span class="comment">web site at: http://bitblaze.cs.berkeley.edu/</span>
<a name="l00011"></a>00011 <span class="comment">*/</span>
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="preprocessor">#ifndef __DISASM_H__</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span><span class="preprocessor">#define __DISASM_H__</span>
<a name="l00015"></a>00015 <span class="preprocessor"></span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &lt;ctype.h&gt;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;setjmp.h&gt;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;unistd.h&gt;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;stdint.h&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;bfd.h&gt;</span>
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
<a name="l00027"></a>00027 <span class="preprocessor">#endif</span>
<a name="l00028"></a>00028 <span class="preprocessor"></span>
<a name="l00029"></a>00029 <span class="preprocessor">#ifndef bfd_get_section_size_before_reloc</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span><span class="preprocessor">#define bfd_get_section_size_before_reloc(x) bfd_get_section_size(x)</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="comment">/**************************** Declarations / Defines **************************/</span>
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="preprocessor">#define STATISTICS</span>
<a name="l00038"></a>00038 <span class="preprocessor"></span>
<a name="l00039"></a>00039 <span class="keyword">struct </span><a class="code" href="structi386__instruction.html">i386_instruction</a>;
<a name="l00040"></a>00040 <span class="keyword">struct </span><a class="code" href="struct__segment.html">_segment</a>;
<a name="l00041"></a>00041 <span class="keyword">struct </span><a class="code" href="structdisassemble__info.html">disassemble_info</a>;
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="preprocessor">#define INST_STOP   0</span>
<a name="l00045"></a>00045 <span class="preprocessor"></span><span class="preprocessor">#define INST_CONT   1</span>
<a name="l00046"></a>00046 <span class="preprocessor"></span><span class="preprocessor">#define INST_JUMP   2</span>
<a name="l00047"></a>00047 <span class="preprocessor"></span><span class="preprocessor">#define INST_BRANCH 3</span>
<a name="l00048"></a>00048 <span class="preprocessor"></span><span class="preprocessor">#define INST_CALL   4</span>
<a name="l00049"></a>00049 <span class="preprocessor"></span>
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 <span class="preprocessor">#define INST_GAP    10</span>
<a name="l00052"></a>00052 <span class="preprocessor"></span>
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="comment">/****************************** Global Variables ******************************/</span>
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="disasm_8h.html#c3e1795766a80ec63b157951b4b9a7d4">debug</a>;
<a name="l00058"></a>00058 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="disasm_8h.html#c1dde3b0d96e2c1bc0c226bc3da59846">statistics</a>;
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="disasm_8h.html#4cb178172578524efdb951b46e1b5a0a">show_asm</a>;
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="comment">/****************************** Interface Functions ***************************/</span>
<a name="l00063"></a>00063 <span class="keyword">struct </span><a class="code" href="structi386__instruction.html">i386_instruction</a>* <a class="code" href="disasm_8h.html#2e6c8f30b14236a4821790fd068c23de">get_i386_insn_buf</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> <a class="code" href="taintcheck_8h.html#c5171f8c3bbd36e5425e886a5e20e790">size</a>);
<a name="l00064"></a>00064 <span class="keyword">struct </span><a class="code" href="structi386__instruction.html">i386_instruction</a>* <a class="code" href="disasm_8h.html#04196fc05d4f5780b6d2a93355aa3cf1">get_i386_insn</a>(<span class="keyword">struct</span> <a class="code" href="structdisassemble__info.html">disassemble_info</a> *<a class="code" href="structi386__instruction.html#2103edcc7f158b8f2931ccd3a04b7932">info</a>, bfd_vma offset, <span class="keyword">struct</span> <a class="code" href="struct__segment.html">_segment</a> *<a class="code" href="structi386__instruction.html#d5fe5c741e91ef4f47bcf5f3e1e5d22e">segment</a>);
<a name="l00065"></a>00065 
<a name="l00066"></a>00066 <span class="keywordtype">int</span> <a class="code" href="disasm_8h.html#b6e02290a7ac223857241f12a574e543">buffer_read_memory</a> (bfd_vma memaddr, bfd_byte *myaddr, 
<a name="l00067"></a>00067             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structi386__instruction.html#ebe5f08b028abf48c1dbaa64b8a4b6aa">length</a>, <span class="keyword">struct</span> <a class="code" href="structdisassemble__info.html">disassemble_info</a> *<a class="code" href="structi386__instruction.html#2103edcc7f158b8f2931ccd3a04b7932">info</a>);
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#4e5b5ef30fe8ca1b222b79b5e2b151f2">init_disasm_info</a>(<span class="keyword">struct</span> <a class="code" href="structdisassemble__info.html">disassemble_info</a> *disasm_info, <span class="keyword">struct</span> <a class="code" href="struct__segment.html">_segment</a> *<a class="code" href="structi386__instruction.html#d5fe5c741e91ef4f47bcf5f3e1e5d22e">segment</a>);
<a name="l00070"></a>00070 <span class="keywordtype">int</span> <a class="code" href="disasm_8h.html#9fe051a2d4515e8659fafb769a3b9b73">is_insn_supported</a>(<span class="keyword">struct</span> <a class="code" href="structi386__instruction.html">i386_instruction</a> *inst); <span class="comment">//added by Heng Yin</span>
<a name="l00071"></a>00071 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#ff5113244dcb26ffcd7a34599ed18fbc">print_i386_insn</a>(<span class="keyword">struct</span> <a class="code" href="structi386__instruction.html">i386_instruction</a> *inst, <span class="keywordtype">int</span> type);
<a name="l00072"></a>00072 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#66cf9f5a64d0f27758d13058a4a4ff87">print_i386_rawbytes</a>(bfd_vma addr, <span class="keyword">const</span> <span class="keywordtype">char</span> *buf, 
<a name="l00073"></a>00073             ssize_t <a class="code" href="taintcheck_8h.html#c5171f8c3bbd36e5425e886a5e20e790">size</a>); 
<a name="l00074"></a>00074 <span class="keywordtype">int</span> <a class="code" href="disasm_8h.html#67e84f9b0cf2c1188741b59268ceb52f">get_i386_insn_length</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *buf);
<a name="l00075"></a>00075 
<a name="l00076"></a>00076 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#a93787dd9bbcd4d88dab9f63d545cba1">disassemble_segment_i386</a>(bfd *abfd, <span class="keyword">struct</span> <a class="code" href="structdisassemble__info.html">disassemble_info</a> *<a class="code" href="structi386__instruction.html#2103edcc7f158b8f2931ccd3a04b7932">info</a>, bfd_vma from, bfd_vma to);
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#dc50f20bada8bab051365a2131d59897">disassemble_i386_data</a>(bfd *abfd, <span class="keywordtype">int</span> print_insn_digraphs, <span class="keywordtype">int</span> interactive);
<a name="l00079"></a>00079  
<a name="l00080"></a>00080 <span class="keyword">struct </span><a class="code" href="structi386__instruction.html">i386_instruction</a>* <a class="code" href="disasm_8h.html#2cdb2fb75559d18a0c5c902c852ab8ea">get_inst_of</a>(bfd_vma pc);
<a name="l00081"></a>00081 
<a name="l00082"></a>00082 <span class="keyword">struct </span><a class="code" href="struct__segment.html">_segment</a>* <a class="code" href="disasm_8h.html#94a618d8b34a0112e91ed08041293224">get_segment_of</a>(bfd_vma addr);
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 <span class="keywordtype">int</span> <a class="code" href="disasm_8h.html#b6e02290a7ac223857241f12a574e543">buffer_read_memory</a> (bfd_vma memaddr, bfd_byte *myaddr, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> length, <span class="keyword">struct</span> <a class="code" href="structdisassemble__info.html">disassemble_info</a> *info);
<a name="l00085"></a>00085 
<a name="l00086"></a>00086 <span class="keywordtype">int</span> <a class="code" href="disasm_8h.html#a8488a694a200e21d2a6f481cdee185f">get_control_transfer_type</a>(<span class="keyword">struct</span> <a class="code" href="structi386__instruction.html">i386_instruction</a> *inst, bfd_vma *target);
<a name="l00087"></a>00087 
<a name="l00088"></a>00088 <span class="keywordtype">void</span> *<a class="code" href="disasm_8h.html#23ce8a9f5c3568f509105cc82d82316e">xalloc</a>(<span class="keywordtype">size_t</span> num, <span class="keywordtype">size_t</span> <a class="code" href="taintcheck_8h.html#c5171f8c3bbd36e5425e886a5e20e790">size</a>);
<a name="l00089"></a>00089 
<a name="l00090"></a>00090 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#677da14e8c4326bde43622f233f1ead3">fatal</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *fmt, ...);
<a name="l00091"></a>00091 
<a name="l00092"></a>00092 <span class="comment">/****************************** Instruction Operands ***************************/</span>
<a name="l00093"></a>00093 
<a name="l00094"></a><a class="code" href="disasm_8h.html#a1aa1c6a8f3bbed5b167bc2d4511b9693cf33e6763da05a2b9e5b6c5e304279a">00094</a> <span class="keyword">enum</span> <a class="code" href="disasm_8h.html#a1aa1c6a8f3bbed5b167bc2d4511b969">OpType</a> { <a class="code" href="disasm_8h.html#a1aa1c6a8f3bbed5b167bc2d4511b969b8f322e6206a76da0c0b0e2662e72e60">TNone</a> = 0, <a class="code" href="disasm_8h.html#a1aa1c6a8f3bbed5b167bc2d4511b9693cf33e6763da05a2b9e5b6c5e304279a">TRegister</a>, <a class="code" href="disasm_8h.html#a1aa1c6a8f3bbed5b167bc2d4511b9693598ee08284e10c6c40b5551da70d15b">TMemLoc</a>, <a class="code" href="disasm_8h.html#a1aa1c6a8f3bbed5b167bc2d4511b969ab5056bc13efb2136b01793558730d16">TImmediate</a>, <a class="code" href="disasm_8h.html#a1aa1c6a8f3bbed5b167bc2d4511b969a777903c3ff38541242440abcc7edc00">TJump</a>, <a class="code" href="disasm_8h.html#a1aa1c6a8f3bbed5b167bc2d4511b96924ac2633e4b9b30a027645d0e6792036">TFloatRegister</a>, <a class="code" href="disasm_8h.html#a1aa1c6a8f3bbed5b167bc2d4511b9699629a8ce829ee05169dda475567ceea4">TMemAddress</a> };
<a name="l00095"></a>00095 
<a name="l00096"></a><a class="code" href="struct__register.html">00096</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__register.html">_register</a> {
<a name="l00097"></a><a class="code" href="struct__register.html#41323e3da16a509736e31d1d01e98140">00097</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="struct__register.html#41323e3da16a509736e31d1d01e98140">num</a>;
<a name="l00098"></a>00098 } <a class="code" href="struct__register.html">Register</a>;
<a name="l00099"></a>00099 
<a name="l00100"></a><a class="code" href="struct__float__register.html">00100</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__float__register.html">_float_register</a> {
<a name="l00101"></a><a class="code" href="struct__float__register.html#76843c0427aa3378a4d4af3b29b458b3">00101</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="struct__float__register.html#76843c0427aa3378a4d4af3b29b458b3">num</a>;
<a name="l00102"></a><a class="code" href="struct__float__register.html#9d891ca9d25e7ce4d70bdfcaee45aa25">00102</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="struct__float__register.html#9d891ca9d25e7ce4d70bdfcaee45aa25">def</a>;
<a name="l00103"></a>00103 } <a class="code" href="struct__float__register.html">FloatRegister</a>;
<a name="l00104"></a>00104 
<a name="l00105"></a><a class="code" href="struct__mem__loc.html">00105</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__mem__loc.html">_mem_loc</a> {
<a name="l00106"></a><a class="code" href="struct__mem__loc.html#0f1edf321d43623c7cf192a9e8bb844c">00106</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="struct__mem__loc.html#0f1edf321d43623c7cf192a9e8bb844c">base</a>;
<a name="l00107"></a><a class="code" href="struct__mem__loc.html#2aae0a81ba714bc5d8e73a675c5251b1">00107</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="struct__mem__loc.html#2aae0a81ba714bc5d8e73a675c5251b1">index</a>;
<a name="l00108"></a><a class="code" href="struct__mem__loc.html#6f82dbfaecab562a9c6cecf26da0ab67">00108</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="struct__mem__loc.html#6f82dbfaecab562a9c6cecf26da0ab67">scale</a>;
<a name="l00109"></a><a class="code" href="struct__mem__loc.html#9eba6eb679a95f4b1a073a60b1d199f9">00109</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="struct__mem__loc.html#9eba6eb679a95f4b1a073a60b1d199f9">displ_t</a>;
<a name="l00110"></a><a class="code" href="struct__mem__loc.html#2e8138ea286619ba879313d6e244463b">00110</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="struct__mem__loc.html#2e8138ea286619ba879313d6e244463b">displ</a>;
<a name="l00111"></a><a class="code" href="struct__mem__loc.html#23c7e7baf8778e090792381023923c25">00111</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="struct__mem__loc.html#23c7e7baf8778e090792381023923c25">segment</a>;
<a name="l00112"></a>00112 } <a class="code" href="struct__mem__loc.html">MemLoc</a>;
<a name="l00113"></a>00113 
<a name="l00114"></a><a class="code" href="struct__immediate.html">00114</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__immediate.html">_immediate</a> {
<a name="l00115"></a><a class="code" href="struct__immediate.html#19455bb40f570ee0e96ddcd32e61e499">00115</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="struct__immediate.html#19455bb40f570ee0e96ddcd32e61e499">type</a>;
<a name="l00116"></a><a class="code" href="struct__immediate.html#4f3492a7adf61a8c0cb5357a2aba91d2">00116</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="struct__immediate.html#4f3492a7adf61a8c0cb5357a2aba91d2">segment</a>;
<a name="l00117"></a><a class="code" href="struct__immediate.html#bdea82a679dcc1f296fe8146c1badc0d">00117</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="struct__immediate.html#bdea82a679dcc1f296fe8146c1badc0d">value</a>;
<a name="l00118"></a>00118 } <a class="code" href="struct__immediate.html">Immediate</a>;
<a name="l00119"></a>00119 
<a name="l00120"></a><a class="code" href="struct__jump.html">00120</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__jump.html">_jump</a> {
<a name="l00121"></a><a class="code" href="struct__jump.html#cb4b3499f54ba8fd95d6f3493843ed4e">00121</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="struct__jump.html#cb4b3499f54ba8fd95d6f3493843ed4e">type</a>;
<a name="l00122"></a><a class="code" href="struct__jump.html#d8bc9e634a67af639b7dcc5d60f6eb10">00122</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="struct__jump.html#d8bc9e634a67af639b7dcc5d60f6eb10">relative</a>;
<a name="l00123"></a><a class="code" href="struct__jump.html#12fcdb2957adb59a09a7b5f9c60c0508">00123</a>   <span class="keywordtype">long</span> <a class="code" href="struct__jump.html#12fcdb2957adb59a09a7b5f9c60c0508">offset</a>;
<a name="l00124"></a><a class="code" href="struct__jump.html#1b8abcd3ef19ae75c704b9fc6e250fb1">00124</a>   bfd_vma <a class="code" href="struct__jump.html#1b8abcd3ef19ae75c704b9fc6e250fb1">target</a>;
<a name="l00125"></a>00125 } <a class="code" href="struct__jump.html">Jump</a>;
<a name="l00126"></a>00126 
<a name="l00127"></a><a class="code" href="structi386__operand.html">00127</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structi386__operand.html">i386_operand</a> {
<a name="l00128"></a>00128 
<a name="l00129"></a><a class="code" href="structi386__operand.html#ba0dc8939b7d72317fbca71f4bc9b6d6">00129</a>   <span class="keyword">enum</span> <a class="code" href="disasm_8h.html#a1aa1c6a8f3bbed5b167bc2d4511b969">OpType</a> <a class="code" href="structi386__operand.html#ba0dc8939b7d72317fbca71f4bc9b6d6">type</a>;
<a name="l00130"></a>00130 
<a name="l00131"></a><a class="code" href="unioni386__operand_1_1OpValue.html">00131</a>   <span class="keyword">union </span><a class="code" href="unioni386__operand_1_1OpValue.html">OpValue</a> {
<a name="l00132"></a><a class="code" href="unioni386__operand_1_1OpValue.html#3edf0918b6b5fa9f6553b15da46f4ed0">00132</a>     <a class="code" href="struct__register.html">Register</a> <a class="code" href="unioni386__operand_1_1OpValue.html#3edf0918b6b5fa9f6553b15da46f4ed0">reg</a>;
<a name="l00133"></a><a class="code" href="unioni386__operand_1_1OpValue.html#b6eb0da6aec1cbaadc09530d75d5a826">00133</a>     <a class="code" href="struct__mem__loc.html">MemLoc</a> <a class="code" href="unioni386__operand_1_1OpValue.html#b6eb0da6aec1cbaadc09530d75d5a826">mem</a>;
<a name="l00134"></a><a class="code" href="unioni386__operand_1_1OpValue.html#dd3994f74a31d750c5f3beca7e2a9554">00134</a>     <a class="code" href="struct__immediate.html">Immediate</a> <a class="code" href="unioni386__operand_1_1OpValue.html#dd3994f74a31d750c5f3beca7e2a9554">imm</a>;
<a name="l00135"></a><a class="code" href="unioni386__operand_1_1OpValue.html#e4b455e061a4d4d747b14eac1321e5e4">00135</a>     <a class="code" href="struct__jump.html">Jump</a> <a class="code" href="unioni386__operand_1_1OpValue.html#e4b455e061a4d4d747b14eac1321e5e4">jmp</a>;
<a name="l00136"></a><a class="code" href="unioni386__operand_1_1OpValue.html#9a56202d8fd1c35bdf88fbe1584f5f75">00136</a>     <a class="code" href="struct__float__register.html">FloatRegister</a> <a class="code" href="unioni386__operand_1_1OpValue.html#9a56202d8fd1c35bdf88fbe1584f5f75">freg</a>;
<a name="l00137"></a>00137   } <a class="code" href="structi386__operand.html#68a4d891f4fd073c287c5013b7525b0c">value</a>;
<a name="l00138"></a>00138 
<a name="l00139"></a><a class="code" href="structi386__operand.html#41377e06a38d5bb4c30e48dc28509746">00139</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="structi386__operand.html#41377e06a38d5bb4c30e48dc28509746">indirect</a>;
<a name="l00140"></a>00140 
<a name="l00141"></a>00141 } <a class="code" href="structi386__operand.html">Operand</a>;
<a name="l00142"></a>00142 
<a name="l00143"></a>00143 
<a name="l00144"></a><a class="code" href="structdisassemble__info.html">00144</a> <span class="keyword">struct </span><a class="code" href="structdisassemble__info.html">disassemble_info</a> {
<a name="l00145"></a><a class="code" href="structdisassemble__info.html#5520f40ad7c41b165d91ac92ce249d95">00145</a>   bfd_vma <a class="code" href="structdisassemble__info.html#5520f40ad7c41b165d91ac92ce249d95">current_addr</a>;
<a name="l00146"></a>00146 
<a name="l00147"></a>00147   <span class="comment">/* These are for buffer_read_memory.  */</span>
<a name="l00148"></a><a class="code" href="structdisassemble__info.html#dd848e6e3c2f025a8b4a64d56751fa9f">00148</a>   bfd_byte *<a class="code" href="structdisassemble__info.html#dd848e6e3c2f025a8b4a64d56751fa9f">buffer</a>;
<a name="l00149"></a><a class="code" href="structdisassemble__info.html#71720c26d9d988ace6f41cd3aebac47f">00149</a>   bfd_vma <a class="code" href="structdisassemble__info.html#71720c26d9d988ace6f41cd3aebac47f">buffer_vma</a>;
<a name="l00150"></a><a class="code" href="structdisassemble__info.html#6df37a9d372ce0920e9f0241793a7d9b">00150</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structdisassemble__info.html#6df37a9d372ce0920e9f0241793a7d9b">buffer_length</a>;
<a name="l00151"></a>00151 
<a name="l00152"></a>00152   <span class="comment">/* Number of octets per incremented target address </span>
<a name="l00153"></a>00153 <span class="comment">     Normally one, but some DSPs have byte sizes of 16 or 32 bits.  */</span>
<a name="l00154"></a><a class="code" href="structdisassemble__info.html#d31b39a7b46486b91ab44595c6d42fb4">00154</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structdisassemble__info.html#d31b39a7b46486b91ab44595c6d42fb4">octets_per_byte</a>;
<a name="l00155"></a>00155 
<a name="l00156"></a>00156   <span class="comment">/* Some targets need information about the current section to accurately</span>
<a name="l00157"></a>00157 <span class="comment">     display insns.  If this is NULL, the target disassembler function</span>
<a name="l00158"></a>00158 <span class="comment">     will have to make its best guess.  */</span>
<a name="l00159"></a><a class="code" href="structdisassemble__info.html#c865d540dbf2bb6e3c086e3b4190a38f">00159</a>   asection *<a class="code" href="structdisassemble__info.html#c865d540dbf2bb6e3c086e3b4190a38f">section</a>;
<a name="l00160"></a>00160 };
<a name="l00161"></a>00161 
<a name="l00162"></a>00162 
<a name="l00163"></a>00163 
<a name="l00164"></a>00164 
<a name="l00165"></a>00165 <span class="comment">/**************************** Queue/Hash Table Structs ************************/</span>
<a name="l00166"></a>00166 
<a name="l00167"></a>00167 <span class="preprocessor">#define HASH_SIZE 128</span>
<a name="l00168"></a>00168 <span class="preprocessor"></span>
<a name="l00169"></a><a class="code" href="struct__element.html">00169</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__element.html">_element</a> {
<a name="l00170"></a><a class="code" href="struct__element.html#dad1ddb45ed02b8ca28e2a1d229a142a">00170</a>   bfd_vma <a class="code" href="struct__element.html#dad1ddb45ed02b8ca28e2a1d229a142a">addr</a>;
<a name="l00171"></a><a class="code" href="struct__element.html#1fcf87016502359d32629297051822da">00171</a>   <span class="keywordtype">void</span> *<a class="code" href="struct__element.html#1fcf87016502359d32629297051822da">data</a>;
<a name="l00172"></a><a class="code" href="struct__element.html#749e64651fb9d75fe00f81fb47456f45">00172</a>   <span class="keyword">struct </span><a class="code" href="struct__element.html">_element</a> *<a class="code" href="struct__element.html#749e64651fb9d75fe00f81fb47456f45">next</a>, *<a class="code" href="struct__element.html#2a43c989789d89b866c5cff1e116873b">list_next</a>;
<a name="l00173"></a>00173   
<a name="l00174"></a>00174 } <a class="code" href="struct__element.html">Element</a>;
<a name="l00175"></a>00175 
<a name="l00176"></a><a class="code" href="struct__queue.html">00176</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__queue.html">_queue</a> {
<a name="l00177"></a><a class="code" href="struct__queue.html#c44196323cfd919622399613c8d37e9f">00177</a>   <span class="keyword">struct </span><a class="code" href="struct__element.html">_element</a> *<a class="code" href="struct__queue.html#2c899ccb334791e0e8e74f4af476c5b9">first</a>, *<a class="code" href="struct__queue.html#c44196323cfd919622399613c8d37e9f">last</a>;
<a name="l00178"></a>00178 } <a class="code" href="struct__queue.html">Queue</a>;
<a name="l00179"></a>00179 
<a name="l00180"></a><a class="code" href="struct__hash__table.html">00180</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__hash__table.html">_hash_table</a> {
<a name="l00181"></a><a class="code" href="struct__hash__table.html#aa7563111b38d835f2128c06b1227705">00181</a>   <a class="code" href="struct__element.html">Element</a>* <a class="code" href="struct__hash__table.html#aa7563111b38d835f2128c06b1227705">table</a>[HASH_SIZE];
<a name="l00182"></a><a class="code" href="struct__hash__table.html#509d7671705111031769e900ebe2463f">00182</a>   <a class="code" href="struct__element.html">Element</a>* <a class="code" href="struct__hash__table.html#509d7671705111031769e900ebe2463f">head</a>;
<a name="l00183"></a>00183 } <a class="code" href="struct__hash__table.html">HashTable</a>;
<a name="l00184"></a>00184 
<a name="l00185"></a>00185 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#07de7e2abd81cb273300274e386f800f">push</a>(<a class="code" href="struct__queue.html">Queue</a> *, bfd_vma, <span class="keywordtype">void</span> *);
<a name="l00186"></a>00186 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#f2b924af132170f4e2d368a304ea9b74">append</a>(<a class="code" href="struct__queue.html">Queue</a> *, bfd_vma, <span class="keywordtype">void</span> *);
<a name="l00187"></a>00187 bfd_vma <a class="code" href="disasm_8h.html#c5e72bc4c00ee36c81f1b6b2804771e7">pop</a>(<a class="code" href="struct__queue.html">Queue</a> *);
<a name="l00188"></a>00188 <span class="keywordtype">int</span> <a class="code" href="disasm_8h.html#084626615135722aa480692f4d231b45">qexists</a>(<a class="code" href="struct__queue.html">Queue</a> *, bfd_vma);
<a name="l00189"></a>00189 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#c884d8139be58275c2b2d17e1152f665">qclear</a>(<a class="code" href="struct__queue.html">Queue</a> *);
<a name="l00190"></a>00190 <span class="keywordtype">void</span>* <a class="code" href="disasm_8h.html#adbf0b52b9de01f889a69ea346ef2a61">qdelete</a>(<a class="code" href="struct__queue.html">Queue</a> *, bfd_vma);
<a name="l00191"></a>00191 
<a name="l00192"></a>00192 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="disasm_8h.html#cd97ee117dbc76a8a4704081d4bbefbd">hash</a>(bfd_vma addr);
<a name="l00193"></a>00193 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#f80cf8cc3096f1742abda8df9ac62384">insert</a>(<a class="code" href="struct__hash__table.html">HashTable</a> *, bfd_vma, <span class="keywordtype">void</span> *);
<a name="l00194"></a>00194 <span class="keywordtype">void</span>* <a class="code" href="disasm_8h.html#a819a8f019355b67975c7be45cdb121f">retrieve</a>(<a class="code" href="struct__hash__table.html">HashTable</a> *, bfd_vma);
<a name="l00195"></a>00195 <span class="keywordtype">int</span> <a class="code" href="disasm_8h.html#c5f2aada8ea7afd452532209ed14840f">hexists</a>(<a class="code" href="struct__hash__table.html">HashTable</a> *, bfd_vma);
<a name="l00196"></a>00196 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#c92aa41da9d088c4c6dbb036c3ba7cd4">hupdate</a>(<a class="code" href="struct__hash__table.html">HashTable</a> *, bfd_vma);
<a name="l00197"></a>00197 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#075152449b73f2743663cda4131d2038">hclear</a>(<a class="code" href="struct__hash__table.html">HashTable</a> *);
<a name="l00198"></a>00198 <span class="keywordtype">void</span>* <a class="code" href="disasm_8h.html#92972fa0cfb4069eef99d51c604d461b">hdelete</a>(<a class="code" href="struct__hash__table.html">HashTable</a> *ht, bfd_vma);
<a name="l00199"></a>00199 
<a name="l00200"></a>00200 
<a name="l00201"></a>00201 <span class="comment">/*************************** Instructions and Blocks **************************/</span>
<a name="l00202"></a>00202 
<a name="l00203"></a><a class="code" href="structi386__instruction.html">00203</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structi386__instruction.html">i386_instruction</a> {
<a name="l00204"></a><a class="code" href="structi386__instruction.html#3782cc9257267d13d3edb2fd9cf86cd5">00204</a>   bfd_vma <a class="code" href="structi386__instruction.html#3782cc9257267d13d3edb2fd9cf86cd5">address</a>;
<a name="l00205"></a>00205   
<a name="l00206"></a><a class="code" href="structi386__instruction.html#91c626112eaf84c629b213c3ea0c1e62">00206</a>   bfd_byte <a class="code" href="structi386__instruction.html#91c626112eaf84c629b213c3ea0c1e62">opcode</a>[3]; 
<a name="l00207"></a>00207  
<a name="l00208"></a><a class="code" href="structi386__instruction.html#6cea994fe6a5c72564d175dda93dc7c8">00208</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structi386__instruction.html#6cea994fe6a5c72564d175dda93dc7c8">prefixes</a>;
<a name="l00209"></a>00209 
<a name="l00210"></a><a class="code" href="structi386__instruction.html#a2d0aa777640e08beb85f1097e285f5b">00210</a>   bfd_byte <a class="code" href="structi386__instruction.html#a2d0aa777640e08beb85f1097e285f5b">modrm</a>;
<a name="l00211"></a>00211   
<a name="l00212"></a><a class="code" href="structi386__instruction.html#9261a746adc85abfc2e79016df1bb4c2">00212</a>   <a class="code" href="structi386__operand.html">Operand</a> <a class="code" href="structi386__instruction.html#9261a746adc85abfc2e79016df1bb4c2">ops</a>[3];
<a name="l00213"></a>00213   
<a name="l00214"></a><a class="code" href="structi386__instruction.html#ebe5f08b028abf48c1dbaa64b8a4b6aa">00214</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="structi386__instruction.html#ebe5f08b028abf48c1dbaa64b8a4b6aa">length</a>;
<a name="l00215"></a>00215 
<a name="l00216"></a><a class="code" href="structi386__instruction.html#d5fe5c741e91ef4f47bcf5f3e1e5d22e">00216</a>   <span class="keyword">struct </span><a class="code" href="struct__segment.html">_segment</a> *<a class="code" href="structi386__instruction.html#d5fe5c741e91ef4f47bcf5f3e1e5d22e">segment</a>;
<a name="l00217"></a>00217 
<a name="l00218"></a><a class="code" href="structi386__instruction.html#2103edcc7f158b8f2931ccd3a04b7932">00218</a>   <span class="keyword">struct </span><a class="code" href="structdisassemble__info.html">disassemble_info</a> *<a class="code" href="structi386__instruction.html#2103edcc7f158b8f2931ccd3a04b7932">info</a>;
<a name="l00219"></a>00219 
<a name="l00220"></a>00220   <span class="comment">/* CFG information */</span>
<a name="l00221"></a>00221   
<a name="l00222"></a><a class="code" href="structi386__instruction.html#9f1319f99447e1a2f1d6418633b09ddb">00222</a>   <a class="code" href="struct__queue.html">Queue</a> *<a class="code" href="structi386__instruction.html#9f1319f99447e1a2f1d6418633b09ddb">children</a>;
<a name="l00223"></a>00223 
<a name="l00224"></a><a class="code" href="structi386__instruction.html#a3791e62f60dff0f1c8bd84de39446f9">00224</a>   <a class="code" href="struct__queue.html">Queue</a> *<a class="code" href="structi386__instruction.html#a3791e62f60dff0f1c8bd84de39446f9">ancestors</a>;
<a name="l00225"></a>00225 
<a name="l00226"></a><a class="code" href="structi386__instruction.html#48bc5c0c95b2658a4be19e141584c545">00226</a>   <span class="keywordtype">int</span> <a class="code" href="structi386__instruction.html#bd7b37aba31a249ffe1ad7ca7d94edf8">cfg</a>, <a class="code" href="structi386__instruction.html#48bc5c0c95b2658a4be19e141584c545">visited</a>;
<a name="l00227"></a>00227 <span class="preprocessor">#ifdef __GNUG__ </span><span class="comment">/* defined by g++ */</span>
<a name="l00228"></a><a class="code" href="structi386__instruction.html#5c404c54814ce5c6313be45d5b938166">00228</a>   <span class="keywordtype">bool</span> <a class="code" href="structi386__instruction.html#5c404c54814ce5c6313be45d5b938166">operator&lt;</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structi386__instruction.html">i386_instruction</a> &amp; other)
<a name="l00229"></a>00229   { <span class="keywordflow">return</span> this-&gt;<a class="code" href="structi386__instruction.html#3782cc9257267d13d3edb2fd9cf86cd5">address</a> &lt; other.<a class="code" href="structi386__instruction.html#3782cc9257267d13d3edb2fd9cf86cd5">address</a>; };
<a name="l00230"></a>00230 <span class="preprocessor">#endif</span>
<a name="l00231"></a>00231 <span class="preprocessor"></span>} <a class="code" href="structi386__instruction.html">Instruction</a>;
<a name="l00232"></a>00232 
<a name="l00233"></a>00233 
<a name="l00234"></a>00234 
<a name="l00235"></a><a class="code" href="struct__basic__block.html">00235</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__basic__block.html">_basic_block</a> {
<a name="l00236"></a><a class="code" href="struct__basic__block.html#8d93aa9f9c5096acaf43201e8840878a">00236</a>   bfd_vma <a class="code" href="struct__basic__block.html#8d93aa9f9c5096acaf43201e8840878a">start_addr</a>;
<a name="l00237"></a><a class="code" href="struct__basic__block.html#e95f5cf8bee8b8041b1437fa64ca57dc">00237</a>   bfd_vma <a class="code" href="struct__basic__block.html#e95f5cf8bee8b8041b1437fa64ca57dc">end_addr</a>;
<a name="l00238"></a><a class="code" href="struct__basic__block.html#c232beef3df0104aa53569958a79c151">00238</a>   <span class="keywordtype">int</span> <a class="code" href="struct__basic__block.html#c232beef3df0104aa53569958a79c151">type</a>;
<a name="l00239"></a><a class="code" href="struct__basic__block.html#a9c5d7ba9b0ae59ec1fc0c618df914f4">00239</a>   <span class="keyword">struct </span><a class="code" href="struct__hash__table.html">_hash_table</a> <a class="code" href="struct__basic__block.html#a9c5d7ba9b0ae59ec1fc0c618df914f4">instructions</a>;
<a name="l00240"></a>00240 
<a name="l00241"></a><a class="code" href="struct__basic__block.html#3fc4c77cd1058297e2a3accac2ed0221">00241</a>   <a class="code" href="struct__queue.html">Queue</a> <a class="code" href="struct__basic__block.html#3fc4c77cd1058297e2a3accac2ed0221">cf_up</a>, <a class="code" href="struct__basic__block.html#760bfd12ef8c3319d51de679bce3ce54">cf_down</a>;
<a name="l00242"></a><a class="code" href="struct__basic__block.html#d62c7a22c802cc91c3d00785be2aed52">00242</a>   <a class="code" href="struct__queue.html">Queue</a> <a class="code" href="struct__basic__block.html#d62c7a22c802cc91c3d00785be2aed52">conflicts</a>;
<a name="l00243"></a>00243 
<a name="l00244"></a>00244   <span class="comment">/* for manipulating the basic block graph */</span>
<a name="l00245"></a><a class="code" href="struct__basic__block.html#4033a2bf848546b5699bedf16d765570">00245</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="struct__basic__block.html#d5d627a38153bdbcaa4ad867ccb09828">mark</a>, <a class="code" href="struct__basic__block.html#318406e4c19137200c91777eb1ecea7d">valid</a>, <a class="code" href="struct__basic__block.html#4033a2bf848546b5699bedf16d765570">visited</a>, <a class="code" href="struct__basic__block.html#3219a5317749d946e46a5f4326641c60">phony</a>;
<a name="l00246"></a><a class="code" href="struct__basic__block.html#2691522f914588a010d458c915de4ece">00246</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="struct__basic__block.html#2691522f914588a010d458c915de4ece">in_degree</a>;
<a name="l00247"></a><a class="code" href="struct__basic__block.html#10e8cedfd9d5e96a0d60cc9f006e52bd">00247</a>   <span class="keyword">struct </span><a class="code" href="struct__basic__block.html">_basic_block</a> *<a class="code" href="struct__basic__block.html#10e8cedfd9d5e96a0d60cc9f006e52bd">next</a>;
<a name="l00248"></a>00248 
<a name="l00249"></a>00249 } <a class="code" href="struct__basic__block.html">BasicBlock</a>;
<a name="l00250"></a>00250 
<a name="l00251"></a>00251 
<a name="l00252"></a><a class="code" href="struct__function.html">00252</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__function.html">_function</a> {
<a name="l00253"></a><a class="code" href="struct__function.html#7a7ac47e229c58e6689dc020aac7cff1">00253</a>   bfd_vma <a class="code" href="struct__function.html#7a7ac47e229c58e6689dc020aac7cff1">start_addr</a>;
<a name="l00254"></a><a class="code" href="struct__function.html#fab7bbadd05b0769191e7784944c92ce">00254</a>   bfd_vma <a class="code" href="struct__function.html#fab7bbadd05b0769191e7784944c92ce">end_addr</a>;
<a name="l00255"></a><a class="code" href="struct__function.html#401aaf2db5ff6f2767bbd3790b292a36">00255</a>   <span class="keyword">struct </span><a class="code" href="struct__segment.html">_segment</a> *<a class="code" href="struct__function.html#401aaf2db5ff6f2767bbd3790b292a36">segment</a>;
<a name="l00256"></a>00256 
<a name="l00257"></a><a class="code" href="struct__function.html#81beee4d341aa8de139fba8a457eca78">00257</a>   <span class="keywordtype">char</span> *<a class="code" href="struct__function.html#81beee4d341aa8de139fba8a457eca78">name</a>;
<a name="l00258"></a><a class="code" href="struct__function.html#276db15b2307a83c860c5293c0cdc3b3">00258</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="struct__function.html#276db15b2307a83c860c5293c0cdc3b3">inst_status</a>;
<a name="l00259"></a><a class="code" href="struct__function.html#0cf837c1966e2e0cff03547532aa82b9">00259</a>   <a class="code" href="struct__basic__block.html">BasicBlock</a> **<a class="code" href="struct__function.html#0cf837c1966e2e0cff03547532aa82b9">inst_block</a>;    
<a name="l00260"></a><a class="code" href="struct__function.html#b741663efb730df376e16a5535a7ce57">00260</a>   <a class="code" href="struct__hash__table.html">HashTable</a> <a class="code" href="struct__function.html#b741663efb730df376e16a5535a7ce57">blocks</a>;
<a name="l00261"></a>00261 
<a name="l00262"></a>00262 } <a class="code" href="struct__function.html">Function</a>;  
<a name="l00263"></a>00263 
<a name="l00264"></a>00264 
<a name="l00265"></a>00265 <span class="comment">/****************************** File Segments *********************************/</span>
<a name="l00266"></a>00266 
<a name="l00267"></a><a class="code" href="struct__segment.html">00267</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__segment.html">_segment</a>
<a name="l00268"></a>00268 {
<a name="l00269"></a><a class="code" href="struct__segment.html#35daad7d87d89d39d96123c95a35cf39">00269</a>   bfd_byte *<a class="code" href="struct__segment.html#35daad7d87d89d39d96123c95a35cf39">data</a>;
<a name="l00270"></a><a class="code" href="struct__segment.html#4353052ba84b94fdc2c607ebf3bccb0e">00270</a>   bfd_size_type <a class="code" href="struct__segment.html#4353052ba84b94fdc2c607ebf3bccb0e">datasize</a>;
<a name="l00271"></a>00271   
<a name="l00272"></a><a class="code" href="struct__segment.html#26369753cbef5376e7c4ba439c490b8d">00272</a>   bfd_vma <a class="code" href="struct__segment.html#26369753cbef5376e7c4ba439c490b8d">start_addr</a>;
<a name="l00273"></a><a class="code" href="struct__segment.html#3983a5064bb7c399cf5845e34d590802">00273</a>   bfd_vma <a class="code" href="struct__segment.html#3983a5064bb7c399cf5845e34d590802">end_addr</a>;
<a name="l00274"></a>00274 
<a name="l00275"></a><a class="code" href="struct__segment.html#5e62f31dc536b2f0a7a9f4eadd38c834">00275</a>   asection *<a class="code" href="struct__segment.html#5e62f31dc536b2f0a7a9f4eadd38c834">section</a>;
<a name="l00276"></a><a class="code" href="struct__segment.html#e91cfe7323d6f6fdf42e5854fe8c9859">00276</a>   <span class="keywordtype">int</span> <a class="code" href="struct__segment.html#e91cfe7323d6f6fdf42e5854fe8c9859">is_code</a>;
<a name="l00277"></a>00277 
<a name="l00278"></a><a class="code" href="struct__segment.html#afa86f3ed9a0bea4e147153e03917fa5">00278</a>   <a class="code" href="structi386__instruction.html">Instruction</a> **<a class="code" href="struct__segment.html#afa86f3ed9a0bea4e147153e03917fa5">insts</a>;
<a name="l00279"></a><a class="code" href="struct__segment.html#ce9b9737544780d3743b2313c604663b">00279</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="struct__segment.html#ce9b9737544780d3743b2313c604663b">status</a>;
<a name="l00280"></a>00280 
<a name="l00281"></a><a class="code" href="struct__segment.html#276977701775ed278597a85f5d3d9c51">00281</a>   <a class="code" href="struct__queue.html">Queue</a> <a class="code" href="struct__segment.html#276977701775ed278597a85f5d3d9c51">functions</a>;
<a name="l00282"></a>00282 
<a name="l00283"></a><a class="code" href="struct__segment.html#2b73fade77e969687c4d5c56c7c7671b">00283</a>   <span class="keyword">struct </span><a class="code" href="struct__segment.html">_segment</a> *<a class="code" href="struct__segment.html#2b73fade77e969687c4d5c56c7c7671b">next</a>;
<a name="l00284"></a>00284 } <a class="code" href="struct__segment.html">Segment</a>;
<a name="l00285"></a>00285 
<a name="l00286"></a>00286 
<a name="l00287"></a>00287 
<a name="l00288"></a>00288 <span class="comment">/****************************** Obfuscation parameters ************************/</span>
<a name="l00289"></a>00289 
<a name="l00290"></a><a class="code" href="struct__obfuscation__params.html">00290</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__obfuscation__params.html">_obfuscation_params</a>
<a name="l00291"></a>00291 {
<a name="l00292"></a><a class="code" href="struct__obfuscation__params.html#7fb3865c1e26113206f3132f0315d9e1">00292</a>   bfd_vma <a class="code" href="struct__obfuscation__params.html#0da4b633edfffc729d848bf9ca69bc7c">table_1</a>, <a class="code" href="struct__obfuscation__params.html#7fb3865c1e26113206f3132f0315d9e1">table_2</a>;
<a name="l00293"></a><a class="code" href="struct__obfuscation__params.html#75d06131435e2366f11327297b3b9235">00293</a>   bfd_vma <a class="code" href="struct__obfuscation__params.html#75d06131435e2366f11327297b3b9235">addr_tab</a>;
<a name="l00294"></a>00294 
<a name="l00295"></a><a class="code" href="struct__obfuscation__params.html#47d62889fc8ed23be6f28952bc9dd2b3">00295</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="struct__obfuscation__params.html#d924fb6eead40f060987f8a68821c820">add_mask</a>, <a class="code" href="struct__obfuscation__params.html#3e64c03d7f6ae55602730e87e7105657">shl_left</a>, <a class="code" href="struct__obfuscation__params.html#47d62889fc8ed23be6f28952bc9dd2b3">shl_right</a>;
<a name="l00296"></a>00296 } <a class="code" href="struct__obfuscation__params.html">ObfuscationParams</a>;
<a name="l00297"></a>00297 
<a name="l00298"></a>00298 
<a name="l00299"></a>00299 
<a name="l00300"></a>00300 
<a name="l00301"></a>00301 <span class="comment">/****************************** Intel-386 Operations ***************************/</span>
<a name="l00302"></a>00302 
<a name="l00303"></a><a class="code" href="disasm_8h.html#7518ac714fced45680fd9bdd9bd92e4d">00303</a> <span class="keyword">typedef</span> void (*<a class="code" href="disasm_8h.html#7518ac714fced45680fd9bdd9bd92e4d">op_rtn</a>)(<a class="code" href="structi386__instruction.html">Instruction</a> *, int, int);
<a name="l00304"></a>00304 
<a name="l00305"></a><a class="code" href="structi386__op.html">00305</a> <span class="keyword">struct </span><a class="code" href="structi386__op.html">i386_op</a>
<a name="l00306"></a>00306 {
<a name="l00307"></a><a class="code" href="structi386__op.html#709876245fc59c6dc6a56d3b8a9560aa">00307</a>   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structi386__op.html#709876245fc59c6dc6a56d3b8a9560aa">mnemonic</a>;
<a name="l00308"></a>00308 
<a name="l00309"></a><a class="code" href="structi386__op.html#048f485549b64be2250ec3e966f72a90">00309</a>   <a class="code" href="disasm_8h.html#7518ac714fced45680fd9bdd9bd92e4d">op_rtn</a> <a class="code" href="structi386__op.html#048f485549b64be2250ec3e966f72a90">op1</a>;
<a name="l00310"></a><a class="code" href="structi386__op.html#a0e65b5ba45127406597cb68a78f845f">00310</a>   <span class="keywordtype">int</span> <a class="code" href="structi386__op.html#a0e65b5ba45127406597cb68a78f845f">bytemode1</a>;
<a name="l00311"></a><a class="code" href="structi386__op.html#b2130a14489af8a5618e04d03a2d2ff5">00311</a>   <a class="code" href="disasm_8h.html#7518ac714fced45680fd9bdd9bd92e4d">op_rtn</a> <a class="code" href="structi386__op.html#b2130a14489af8a5618e04d03a2d2ff5">op2</a>;
<a name="l00312"></a><a class="code" href="structi386__op.html#b281696c673cda5afa2c866c1a2b0cce">00312</a>   <span class="keywordtype">int</span> <a class="code" href="structi386__op.html#b281696c673cda5afa2c866c1a2b0cce">bytemode2</a>;
<a name="l00313"></a><a class="code" href="structi386__op.html#ea94ba3fdc031b31129f4ae05597c751">00313</a>   <a class="code" href="disasm_8h.html#7518ac714fced45680fd9bdd9bd92e4d">op_rtn</a> <a class="code" href="structi386__op.html#ea94ba3fdc031b31129f4ae05597c751">op3</a>;
<a name="l00314"></a><a class="code" href="structi386__op.html#e65f53201a295fd86020994d70a0aea9">00314</a>   <span class="keywordtype">int</span> <a class="code" href="structi386__op.html#e65f53201a295fd86020994d70a0aea9">bytemode3</a>;
<a name="l00315"></a>00315 };
<a name="l00316"></a>00316 
<a name="l00317"></a>00317 
<a name="l00318"></a>00318 <span class="comment">/* PREFIX flags */</span>
<a name="l00319"></a>00319 <span class="preprocessor">#define PREFIX_REPZ 1</span>
<a name="l00320"></a>00320 <span class="preprocessor"></span><span class="preprocessor">#define PREFIX_REPNZ 2</span>
<a name="l00321"></a>00321 <span class="preprocessor"></span><span class="preprocessor">#define PREFIX_LOCK 4</span>
<a name="l00322"></a>00322 <span class="preprocessor"></span><span class="preprocessor">#define PREFIX_CS 8</span>
<a name="l00323"></a>00323 <span class="preprocessor"></span><span class="preprocessor">#define PREFIX_SS 0x10</span>
<a name="l00324"></a>00324 <span class="preprocessor"></span><span class="preprocessor">#define PREFIX_DS 0x20</span>
<a name="l00325"></a>00325 <span class="preprocessor"></span><span class="preprocessor">#define PREFIX_ES 0x40</span>
<a name="l00326"></a>00326 <span class="preprocessor"></span><span class="preprocessor">#define PREFIX_FS 0x80</span>
<a name="l00327"></a>00327 <span class="preprocessor"></span><span class="preprocessor">#define PREFIX_GS 0x100</span>
<a name="l00328"></a>00328 <span class="preprocessor"></span><span class="preprocessor">#define PREFIX_OP 0x200</span>
<a name="l00329"></a>00329 <span class="preprocessor"></span><span class="preprocessor">#define PREFIX_ADDR 0x400</span>
<a name="l00330"></a>00330 <span class="preprocessor"></span><span class="preprocessor">#define PREFIX_FWAIT 0x800</span>
<a name="l00331"></a>00331 <span class="preprocessor"></span><span class="preprocessor">#define PREFIX_TAKEN 0x1000</span>
<a name="l00332"></a>00332 <span class="preprocessor"></span><span class="preprocessor">#define PREFIX_NOT_TAKEN 0x2000</span>
<a name="l00333"></a>00333 <span class="preprocessor"></span>
<a name="l00334"></a>00334 
<a name="l00335"></a>00335 <span class="comment">/*** Address Modes ***/</span>
<a name="l00336"></a>00336 
<a name="l00337"></a>00337 <span class="preprocessor">#define b_mode 1  </span><span class="comment">/* byte operand */</span>
<a name="l00338"></a>00338 <span class="preprocessor">#define w_mode 2  </span><span class="comment">/* word operand */</span>
<a name="l00339"></a>00339 <span class="preprocessor">#define d_mode 3  </span><span class="comment">/* double word operand  */</span>
<a name="l00340"></a>00340 
<a name="l00341"></a>00341 <span class="preprocessor">#define v_mode 5  </span><span class="comment">/* operand size depends on prefixes */</span>
<a name="l00342"></a>00342 
<a name="l00343"></a>00343 
<a name="l00344"></a>00344 <span class="comment">/*** Define Registers ***/</span>
<a name="l00345"></a>00345 
<a name="l00346"></a>00346 <span class="comment">/* segment registers */</span>
<a name="l00347"></a>00347 <span class="preprocessor">#define es_reg 100</span>
<a name="l00348"></a>00348 <span class="preprocessor"></span><span class="preprocessor">#define cs_reg 101</span>
<a name="l00349"></a>00349 <span class="preprocessor"></span><span class="preprocessor">#define ss_reg 102</span>
<a name="l00350"></a>00350 <span class="preprocessor"></span><span class="preprocessor">#define ds_reg 103</span>
<a name="l00351"></a>00351 <span class="preprocessor"></span><span class="preprocessor">#define fs_reg 104</span>
<a name="l00352"></a>00352 <span class="preprocessor"></span><span class="preprocessor">#define gs_reg 105</span>
<a name="l00353"></a>00353 <span class="preprocessor"></span>
<a name="l00354"></a>00354 <span class="comment">/* address-modifier dependent registers */</span>
<a name="l00355"></a>00355 <span class="preprocessor">#define eAX_reg 108</span>
<a name="l00356"></a>00356 <span class="preprocessor"></span><span class="preprocessor">#define eCX_reg 109</span>
<a name="l00357"></a>00357 <span class="preprocessor"></span><span class="preprocessor">#define eDX_reg 110</span>
<a name="l00358"></a>00358 <span class="preprocessor"></span><span class="preprocessor">#define eBX_reg 111</span>
<a name="l00359"></a>00359 <span class="preprocessor"></span><span class="preprocessor">#define eSP_reg 112</span>
<a name="l00360"></a>00360 <span class="preprocessor"></span><span class="preprocessor">#define eBP_reg 113</span>
<a name="l00361"></a>00361 <span class="preprocessor"></span><span class="preprocessor">#define eSI_reg 114</span>
<a name="l00362"></a>00362 <span class="preprocessor"></span><span class="preprocessor">#define eDI_reg 115</span>
<a name="l00363"></a>00363 <span class="preprocessor"></span>
<a name="l00364"></a>00364 <span class="comment">/* 8-bit registers */</span>
<a name="l00365"></a>00365 <span class="preprocessor">#define al_reg 116</span>
<a name="l00366"></a>00366 <span class="preprocessor"></span><span class="preprocessor">#define cl_reg 117</span>
<a name="l00367"></a>00367 <span class="preprocessor"></span><span class="preprocessor">#define dl_reg 118</span>
<a name="l00368"></a>00368 <span class="preprocessor"></span><span class="preprocessor">#define bl_reg 119</span>
<a name="l00369"></a>00369 <span class="preprocessor"></span><span class="preprocessor">#define ah_reg 120</span>
<a name="l00370"></a>00370 <span class="preprocessor"></span><span class="preprocessor">#define ch_reg 121</span>
<a name="l00371"></a>00371 <span class="preprocessor"></span><span class="preprocessor">#define dh_reg 122</span>
<a name="l00372"></a>00372 <span class="preprocessor"></span><span class="preprocessor">#define bh_reg 123</span>
<a name="l00373"></a>00373 <span class="preprocessor"></span>
<a name="l00374"></a>00374 <span class="comment">/* 16-bit registers */</span>
<a name="l00375"></a>00375 <span class="preprocessor">#define ax_reg 124</span>
<a name="l00376"></a>00376 <span class="preprocessor"></span><span class="preprocessor">#define cx_reg 125</span>
<a name="l00377"></a>00377 <span class="preprocessor"></span><span class="preprocessor">#define dx_reg 126</span>
<a name="l00378"></a>00378 <span class="preprocessor"></span><span class="preprocessor">#define bx_reg 127</span>
<a name="l00379"></a>00379 <span class="preprocessor"></span><span class="preprocessor">#define sp_reg 128</span>
<a name="l00380"></a>00380 <span class="preprocessor"></span><span class="preprocessor">#define bp_reg 129</span>
<a name="l00381"></a>00381 <span class="preprocessor"></span><span class="preprocessor">#define si_reg 130</span>
<a name="l00382"></a>00382 <span class="preprocessor"></span><span class="preprocessor">#define di_reg 131</span>
<a name="l00383"></a>00383 <span class="preprocessor"></span>
<a name="l00384"></a>00384 <span class="comment">/* 32-bit registers */</span>
<a name="l00385"></a>00385 <span class="preprocessor">#define eax_reg 132</span>
<a name="l00386"></a>00386 <span class="preprocessor"></span><span class="preprocessor">#define ecx_reg 133</span>
<a name="l00387"></a>00387 <span class="preprocessor"></span><span class="preprocessor">#define edx_reg 134</span>
<a name="l00388"></a>00388 <span class="preprocessor"></span><span class="preprocessor">#define ebx_reg 135</span>
<a name="l00389"></a>00389 <span class="preprocessor"></span><span class="preprocessor">#define esp_reg 136</span>
<a name="l00390"></a>00390 <span class="preprocessor"></span><span class="preprocessor">#define ebp_reg 137</span>
<a name="l00391"></a>00391 <span class="preprocessor"></span><span class="preprocessor">#define esi_reg 138</span>
<a name="l00392"></a>00392 <span class="preprocessor"></span><span class="preprocessor">#define edi_reg 139</span>
<a name="l00393"></a>00393 <span class="preprocessor"></span>
<a name="l00394"></a>00394 
<a name="l00395"></a>00395 <span class="preprocessor">#define indir_dx_reg 150</span>
<a name="l00396"></a>00396 <span class="preprocessor"></span>
<a name="l00397"></a>00397 
<a name="l00398"></a>00398 <span class="comment">/*** Operand Function Prototypes ***/</span>
<a name="l00399"></a>00399 
<a name="l00400"></a>00400 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#49445b98153249e2b3fd2a2e6a1b2e6c">OP_REG</a>(Instruction *, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>);
<a name="l00401"></a>00401 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#6836cc17ea6233a210233bce38f77456">OP_I</a>(Instruction * , <span class="keywordtype">int</span>, <span class="keywordtype">int</span>);
<a name="l00402"></a>00402 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#ba7db279b7c9c93f3946569b383f9fe4">OP_sI</a>(Instruction *, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>);
<a name="l00403"></a>00403 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#54875bd6977331dc8fc41666730170a6">OP_E</a>(Instruction *, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>);
<a name="l00404"></a>00404 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#4eefbbbb617ab2bf65fa989eecbec69f">OP_G</a>(Instruction *, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>);
<a name="l00405"></a>00405 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#3b56cb1b54525b662643bd5a2b66f3c9">OP_SEG</a>(Instruction *, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>);
<a name="l00406"></a>00406 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#3fea02d0dcdc4778b6f8e2448f71de02">OP_IMREG</a>(Instruction *, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>);
<a name="l00407"></a>00407 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#cfef7b08bc437a8438ec5447c369a297">OP_DSreg</a>(Instruction *, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>);
<a name="l00408"></a>00408 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#f246337e290e47ddb6c61f6d7f4b9f56">OP_ESreg</a>(Instruction *, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>);
<a name="l00409"></a>00409 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#dcc0050898332fa9bbb8d206aa9f242b">OP_DIR</a>(Instruction *, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>);
<a name="l00410"></a>00410 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#9265d107a8b678e9231e4aba91c898ab">OP_OFF</a>(Instruction *, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>);
<a name="l00411"></a>00411 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#99e112b029cf2fce42f70f3147be03ca">OP_J</a>(Instruction *, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>);
<a name="l00412"></a>00412 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#2fbbb0c997ac3066254f38d4b1dabb5b">OP_indirE</a>(Instruction *, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>);
<a name="l00413"></a>00413 
<a name="l00414"></a>00414 <span class="comment">/* void OP_C(Instruction *, int, int); */</span>
<a name="l00415"></a>00415 <span class="comment">/* void OP_Rd(Instruction *, int, int); */</span>
<a name="l00416"></a>00416 <span class="comment">/* void OP_D(Instruction *, int, int); */</span>
<a name="l00417"></a>00417 <span class="comment">/* void OP_T(Instruction *, int, int); */</span>
<a name="l00418"></a>00418 
<a name="l00419"></a>00419 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#493f38c8a6ae7c0d64adf1e6fdefe447">OP_ST</a>(Instruction *, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>);
<a name="l00420"></a>00420 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#ef833a1d2afb4fb9030cc462f365b0da">OP_STi</a>(Instruction *, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>);
<a name="l00421"></a>00421 
<a name="l00422"></a>00422 
<a name="l00423"></a>00423 <span class="comment">/*** Operand Selectors ***/</span>
<a name="l00424"></a>00424 
<a name="l00425"></a>00425 <span class="preprocessor">#define XX NULL, 0</span>
<a name="l00426"></a>00426 <span class="preprocessor"></span>
<a name="l00427"></a>00427 <span class="preprocessor">#define Eb OP_E, b_mode</span>
<a name="l00428"></a>00428 <span class="preprocessor"></span><span class="preprocessor">#define Ew OP_E, w_mode</span>
<a name="l00429"></a>00429 <span class="preprocessor"></span><span class="preprocessor">#define Ed OP_E, d_mode</span>
<a name="l00430"></a>00430 <span class="preprocessor"></span><span class="preprocessor">#define Ev OP_E, v_mode</span>
<a name="l00431"></a>00431 <span class="preprocessor"></span>
<a name="l00432"></a>00432 <span class="preprocessor">#define Gb OP_G, b_mode</span>
<a name="l00433"></a>00433 <span class="preprocessor"></span><span class="preprocessor">#define Gd OP_G, d_mode</span>
<a name="l00434"></a>00434 <span class="preprocessor"></span><span class="preprocessor">#define Gw OP_G, w_mode</span>
<a name="l00435"></a>00435 <span class="preprocessor"></span><span class="preprocessor">#define Gv OP_G, v_mode</span>
<a name="l00436"></a>00436 <span class="preprocessor"></span>
<a name="l00437"></a>00437 <span class="preprocessor">#define Ib OP_I, b_mode</span>
<a name="l00438"></a>00438 <span class="preprocessor"></span><span class="preprocessor">#define sIb OP_sI, b_mode </span><span class="comment">/* sign extened byte */</span>
<a name="l00439"></a>00439 <span class="preprocessor">#define Iv OP_I, v_mode</span>
<a name="l00440"></a>00440 <span class="preprocessor"></span><span class="preprocessor">#define Iw OP_I, w_mode</span>
<a name="l00441"></a>00441 <span class="preprocessor"></span>
<a name="l00442"></a>00442 <span class="preprocessor">#define eAX OP_REG, eAX_reg</span>
<a name="l00443"></a>00443 <span class="preprocessor"></span><span class="preprocessor">#define eBX OP_REG, eBX_reg</span>
<a name="l00444"></a>00444 <span class="preprocessor"></span><span class="preprocessor">#define eCX OP_REG, eCX_reg</span>
<a name="l00445"></a>00445 <span class="preprocessor"></span><span class="preprocessor">#define eDX OP_REG, eDX_reg</span>
<a name="l00446"></a>00446 <span class="preprocessor"></span><span class="preprocessor">#define eSP OP_REG, eSP_reg</span>
<a name="l00447"></a>00447 <span class="preprocessor"></span><span class="preprocessor">#define eBP OP_REG, eBP_reg</span>
<a name="l00448"></a>00448 <span class="preprocessor"></span><span class="preprocessor">#define eSI OP_REG, eSI_reg</span>
<a name="l00449"></a>00449 <span class="preprocessor"></span><span class="preprocessor">#define eDI OP_REG, eDI_reg</span>
<a name="l00450"></a>00450 <span class="preprocessor"></span>
<a name="l00451"></a>00451 <span class="preprocessor">#define AL OP_REG, al_reg</span>
<a name="l00452"></a>00452 <span class="preprocessor"></span><span class="preprocessor">#define BL OP_REG, bl_reg</span>
<a name="l00453"></a>00453 <span class="preprocessor"></span><span class="preprocessor">#define CL OP_REG, cl_reg</span>
<a name="l00454"></a>00454 <span class="preprocessor"></span><span class="preprocessor">#define DL OP_REG, dl_reg</span>
<a name="l00455"></a>00455 <span class="preprocessor"></span>
<a name="l00456"></a>00456 <span class="preprocessor">#define AH OP_REG, ah_reg</span>
<a name="l00457"></a>00457 <span class="preprocessor"></span><span class="preprocessor">#define BH OP_REG, bh_reg</span>
<a name="l00458"></a>00458 <span class="preprocessor"></span><span class="preprocessor">#define CH OP_REG, ch_reg</span>
<a name="l00459"></a>00459 <span class="preprocessor"></span><span class="preprocessor">#define DH OP_REG, dh_reg</span>
<a name="l00460"></a>00460 <span class="preprocessor"></span>
<a name="l00461"></a>00461 <span class="preprocessor">#define AX OP_REG, ax_reg</span>
<a name="l00462"></a>00462 <span class="preprocessor"></span><span class="preprocessor">#define BX OP_REG, bx_reg</span>
<a name="l00463"></a>00463 <span class="preprocessor"></span><span class="preprocessor">#define CX OP_REG, cx_reg</span>
<a name="l00464"></a>00464 <span class="preprocessor"></span><span class="preprocessor">#define DX OP_REG, dx_reg</span>
<a name="l00465"></a>00465 <span class="preprocessor"></span>
<a name="l00466"></a>00466 <span class="preprocessor">#define ES OP_REG, es_reg</span>
<a name="l00467"></a>00467 <span class="preprocessor"></span><span class="preprocessor">#define SS OP_REG, ss_reg</span>
<a name="l00468"></a>00468 <span class="preprocessor"></span><span class="preprocessor">#define CS OP_REG, cs_reg</span>
<a name="l00469"></a>00469 <span class="preprocessor"></span><span class="preprocessor">#define DS OP_REG, ds_reg</span>
<a name="l00470"></a>00470 <span class="preprocessor"></span><span class="preprocessor">#define FS OP_REG, fs_reg</span>
<a name="l00471"></a>00471 <span class="preprocessor"></span><span class="preprocessor">#define GS OP_REG, gs_reg</span>
<a name="l00472"></a>00472 <span class="preprocessor"></span>
<a name="l00473"></a>00473 <span class="preprocessor">#define indirDX OP_IMREG, dx_reg</span>
<a name="l00474"></a>00474 <span class="preprocessor"></span><span class="preprocessor">#define Xb OP_DSreg, eSI_reg</span>
<a name="l00475"></a>00475 <span class="preprocessor"></span><span class="preprocessor">#define Xv OP_DSreg, eSI_reg</span>
<a name="l00476"></a>00476 <span class="preprocessor"></span><span class="preprocessor">#define Yb OP_ESreg, eDI_reg</span>
<a name="l00477"></a>00477 <span class="preprocessor"></span><span class="preprocessor">#define Yv OP_ESreg, eDI_reg</span>
<a name="l00478"></a>00478 <span class="preprocessor"></span><span class="preprocessor">#define DSBX OP_DSreg, eBX_reg</span>
<a name="l00479"></a>00479 <span class="preprocessor"></span>
<a name="l00480"></a>00480 <span class="preprocessor">#define Ma OP_E, v_mode</span>
<a name="l00481"></a>00481 <span class="preprocessor"></span><span class="preprocessor">#define M OP_E, 0   </span><span class="comment">/* lea, lgdt, etc. */</span>
<a name="l00482"></a>00482 <span class="preprocessor">#define Mp OP_E, 0    </span><span class="comment">/* 32 or 48 bit memory operand for LDS, LES etc */</span>
<a name="l00483"></a>00483 
<a name="l00484"></a>00484 <span class="preprocessor">#define Sw OP_SEG, w_mode</span>
<a name="l00485"></a>00485 <span class="preprocessor"></span>
<a name="l00486"></a>00486 <span class="preprocessor">#define Ap OP_DIR, 0</span>
<a name="l00487"></a>00487 <span class="preprocessor"></span>
<a name="l00488"></a>00488 <span class="preprocessor">#define Ob64 OP_OFF, b_mode</span>
<a name="l00489"></a>00489 <span class="preprocessor"></span><span class="preprocessor">#define Ov64 OP_OFF, v_mode</span>
<a name="l00490"></a>00490 <span class="preprocessor"></span>
<a name="l00491"></a>00491 <span class="preprocessor">#define indirEv OP_indirE, v_mode</span>
<a name="l00492"></a>00492 <span class="preprocessor"></span>
<a name="l00493"></a>00493 <span class="preprocessor">#define Jb OP_J, b_mode</span>
<a name="l00494"></a>00494 <span class="preprocessor"></span><span class="preprocessor">#define Jv OP_J, v_mode</span>
<a name="l00495"></a>00495 <span class="preprocessor"></span>
<a name="l00496"></a>00496 <span class="preprocessor">#define ST OP_ST, 0</span>
<a name="l00497"></a>00497 <span class="preprocessor"></span><span class="preprocessor">#define STi OP_STi, 0</span>
<a name="l00498"></a>00498 <span class="preprocessor"></span>
<a name="l00499"></a>00499 
<a name="l00500"></a>00500 <span class="comment">/* #define Cm OP_C, d_mode */</span>
<a name="l00501"></a>00501 <span class="comment">/* #define Rd OP_Rd, d_mode */</span>
<a name="l00502"></a>00502 <span class="comment">/* #define Rm OP_Rd, d_mode */</span>
<a name="l00503"></a>00503 <span class="comment">/* #define Dm OP_D, d_mode */</span>
<a name="l00504"></a>00504 <span class="comment">/* #define Td OP_T, d_mode */</span>
<a name="l00505"></a>00505 
<a name="l00506"></a>00506 
<a name="l00507"></a>00507 <span class="keyword">extern</span> <span class="keyword">struct </span><a class="code" href="structi386__op.html">i386_op</a> <a class="code" href="disasm_8h.html#9b8fff046a88be25df9f71adbb3b14b7">i386_op_1</a>[];
<a name="l00508"></a>00508 <span class="keyword">extern</span> <span class="keyword">struct </span><a class="code" href="structi386__op.html">i386_op</a> <a class="code" href="disasm_8h.html#858d269537408275895cc81402708ceb">i386_op_2</a>[];
<a name="l00509"></a>00509 
<a name="l00510"></a>00510 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="disasm_8h.html#fb99cb742e1f3260b2c5a0a991430423">onebyte_has_modrm</a>[256];
<a name="l00511"></a>00511 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="disasm_8h.html#8a77312545d7177e4682bbf4fcc94899">onebyte_is_group</a>[256];
<a name="l00512"></a>00512 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="disasm_8h.html#4a93d9898552654097c346a741f97d3e">twobyte_has_modrm</a>[256];
<a name="l00513"></a>00513 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="disasm_8h.html#0d88f0fe2ac837603ae94ea00ac69cfa">twobyte_is_group</a>[256];
<a name="l00514"></a>00514 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="disasm_8h.html#c4ab5fc21f5df471973270c73e981d52">twobyte_uses_SSE_prefix</a>[256];
<a name="l00515"></a>00515 
<a name="l00516"></a>00516 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="disasm_8h.html#8ab9b852abac25790c34db92f6e24d5e">intel_names32</a>[];
<a name="l00517"></a>00517 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="disasm_8h.html#68904e9cfdadcc1caa55e80cdba2579c">intel_names16</a>[];
<a name="l00518"></a>00518 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="disasm_8h.html#9deadfa1c9e55e442a0d63c6b92482a9">intel_names8</a>[]; 
<a name="l00519"></a>00519 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="disasm_8h.html#49bc922a3feabf73f9374a9f59ec3623">intel_names_seg</a>[]; 
<a name="l00520"></a>00520 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="disasm_8h.html#aaf269da2482962d9064f7b4ea35e790">intel_index16</a>[];
<a name="l00521"></a>00521 
<a name="l00522"></a>00522 
<a name="l00523"></a>00523 
<a name="l00524"></a>00524 
<a name="l00525"></a>00525 <span class="comment">/* Floating Point */</span>
<a name="l00526"></a>00526 
<a name="l00527"></a>00527 <span class="preprocessor">#define FGRPd9_2 NULL, NULL, 0, NULL, 0, NULL, 0</span>
<a name="l00528"></a>00528 <span class="preprocessor"></span><span class="preprocessor">#define FGRPd9_4 NULL, NULL, 1, NULL, 0, NULL, 0</span>
<a name="l00529"></a>00529 <span class="preprocessor"></span><span class="preprocessor">#define FGRPd9_5 NULL, NULL, 2, NULL, 0, NULL, 0</span>
<a name="l00530"></a>00530 <span class="preprocessor"></span><span class="preprocessor">#define FGRPd9_6 NULL, NULL, 3, NULL, 0, NULL, 0</span>
<a name="l00531"></a>00531 <span class="preprocessor"></span><span class="preprocessor">#define FGRPd9_7 NULL, NULL, 4, NULL, 0, NULL, 0</span>
<a name="l00532"></a>00532 <span class="preprocessor"></span><span class="preprocessor">#define FGRPda_5 NULL, NULL, 5, NULL, 0, NULL, 0</span>
<a name="l00533"></a>00533 <span class="preprocessor"></span><span class="preprocessor">#define FGRPdb_4 NULL, NULL, 6, NULL, 0, NULL, 0</span>
<a name="l00534"></a>00534 <span class="preprocessor"></span><span class="preprocessor">#define FGRPde_3 NULL, NULL, 7, NULL, 0, NULL, 0</span>
<a name="l00535"></a>00535 <span class="preprocessor"></span><span class="preprocessor">#define FGRPdf_4 NULL, NULL, 8, NULL, 0, NULL, 0</span>
<a name="l00536"></a>00536 <span class="preprocessor"></span>
<a name="l00537"></a>00537 <span class="keyword">extern</span> <span class="keyword">struct </span><a class="code" href="structi386__op.html">i386_op</a> <a class="code" href="disasm_8h.html#fcc409680c375bda0b4a58e33320bd87">float_reg</a>[][8];
<a name="l00538"></a>00538 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="disasm_8h.html#f48f6bdaa87b723ffeaafb2054a9c5cb">fgrps</a>[][8];
<a name="l00539"></a>00539 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="disasm_8h.html#2bada08019d3231814e2a602266a6436">float_mem</a>[];
<a name="l00540"></a>00540 
<a name="l00541"></a>00541 
<a name="l00542"></a>00542 <span class="comment">/* Instruction Groups */</span>
<a name="l00543"></a>00543 
<a name="l00544"></a>00544 <span class="preprocessor">#define GRP0  NULL,  0</span>
<a name="l00545"></a>00545 <span class="preprocessor"></span><span class="preprocessor">#define GRP1  NULL,  1</span>
<a name="l00546"></a>00546 <span class="preprocessor"></span><span class="preprocessor">#define GRP2  NULL,  2</span>
<a name="l00547"></a>00547 <span class="preprocessor"></span><span class="preprocessor">#define GRP3  NULL,  3</span>
<a name="l00548"></a>00548 <span class="preprocessor"></span><span class="preprocessor">#define GRP4  NULL,  4</span>
<a name="l00549"></a>00549 <span class="preprocessor"></span><span class="preprocessor">#define GRP5  NULL,  5</span>
<a name="l00550"></a>00550 <span class="preprocessor"></span><span class="preprocessor">#define GRP6  NULL,  6</span>
<a name="l00551"></a>00551 <span class="preprocessor"></span><span class="preprocessor">#define GRP7  NULL,  7</span>
<a name="l00552"></a>00552 <span class="preprocessor"></span><span class="preprocessor">#define GRP8  NULL,  8</span>
<a name="l00553"></a>00553 <span class="preprocessor"></span><span class="preprocessor">#define GRP9  NULL,  9</span>
<a name="l00554"></a>00554 <span class="preprocessor"></span><span class="preprocessor">#define GRP10 NULL, 10</span>
<a name="l00555"></a>00555 <span class="preprocessor"></span><span class="preprocessor">#define GRP11 NULL, 11</span>
<a name="l00556"></a>00556 <span class="preprocessor"></span><span class="preprocessor">#define GRP12 NULL, 12</span>
<a name="l00557"></a>00557 <span class="preprocessor"></span><span class="preprocessor">#define GRP13 NULL, 13</span>
<a name="l00558"></a>00558 <span class="preprocessor"></span>
<a name="l00559"></a>00559 <span class="keyword">extern</span> <span class="keyword">struct </span><a class="code" href="structi386__op.html">i386_op</a> <a class="code" href="disasm_8h.html#068d22a4532b0dd5233f468ce3af614f">i386_group_1</a>[][8];
<a name="l00560"></a>00560 <span class="keyword">extern</span> <span class="keyword">struct </span><a class="code" href="structi386__op.html">i386_op</a> <a class="code" href="disasm_8h.html#e14d671a63bb3a587c11d28c827eab53">i386_group_2</a>[][8];
<a name="l00561"></a>00561 
<a name="l00562"></a>00562 <span class="comment">/* Weights */</span>
<a name="l00563"></a>00563 <span class="preprocessor">#define WEIGHT_INST_COUNT 0.25 </span><span class="comment">/**&lt; Instruction count weight */</span>
<a name="l00564"></a>00564 <span class="preprocessor">#define WEIGHT_INST_DIGRAPH 0.5 </span><span class="comment">/**&lt; Instruction digraph weight */</span>
<a name="l00565"></a>00565 <span class="preprocessor">#define WEIGHT_INST_OP_SIZE_MISMATCH 0.9 </span><span class="comment">/**&lt; Instruction operand size mismatch */</span>
<a name="l00566"></a>00566 <span class="preprocessor">#define WEIGHT_INST_MOV_REG_OWN_REF 0.9 </span><span class="comment">/**&lt; Move an instruction into its own reference */</span>
<a name="l00567"></a>00567 <span class="preprocessor">#define WEIGHT_INST_MOV_EBP_ESP_MISMATCH 0.7 </span><span class="comment">/**&lt; Move %esp or %ebp into weird registers */</span>
<a name="l00568"></a>00568 <span class="preprocessor">#define WEIGHT_ARITHMETIC_SPECIAL_REG 0.8 </span><span class="comment">/**&lt; Uncommon arithmetic on a special register */</span>
<a name="l00569"></a>00569 <span class="preprocessor">#define WEIGHT_0x00_OPCODE 0.9 </span><span class="comment">/**&lt; 0x00 opcode */</span>
<a name="l00570"></a>00570 <span class="preprocessor">#define WEIGHT_NOP 0.2 </span><span class="comment">/**&lt; 0x00 opcode */</span>
<a name="l00571"></a>00571 <span class="comment"></span>
<a name="l00572"></a>00572 <span class="comment">/**</span>
<a name="l00573"></a>00573 <span class="comment"> * Print error and exit.</span>
<a name="l00574"></a>00574 <span class="comment"> */</span>
<a name="l00575"></a>00575 <span class="comment">/* #define fatal(args...) { \</span>
<a name="l00576"></a>00576 <span class="comment">  fprintf(stderr, args); \</span>
<a name="l00577"></a>00577 <span class="comment">  exit(1); \</span>
<a name="l00578"></a>00578 <span class="comment">  } */</span>
<a name="l00579"></a>00579 <span class="comment"></span>
<a name="l00580"></a>00580 <span class="comment">/**</span>
<a name="l00581"></a>00581 <span class="comment"> * Determine if an instruction is a MOV instruction.</span>
<a name="l00582"></a>00582 <span class="comment"> *</span>
<a name="l00583"></a>00583 <span class="comment"> * @param i Instruction.</span>
<a name="l00584"></a>00584 <span class="comment"> * @return True if MOV, otherwise false.</span>
<a name="l00585"></a>00585 <span class="comment"> */</span>
<a name="l00586"></a>00586 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="disasm_8h.html#8c095222a7ac93c88a1759350f243591">is_mov</a>(Instruction *i);
<a name="l00587"></a>00587 <span class="comment"></span>
<a name="l00588"></a>00588 <span class="comment">/**</span>
<a name="l00589"></a>00589 <span class="comment"> * Determine if an instruction is a MUL instruction.</span>
<a name="l00590"></a>00590 <span class="comment"> *</span>
<a name="l00591"></a>00591 <span class="comment"> * @param i Instruction.</span>
<a name="l00592"></a>00592 <span class="comment"> * @return True if MUL, otherwise false.</span>
<a name="l00593"></a>00593 <span class="comment"> */</span>
<a name="l00594"></a>00594 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="disasm_8h.html#b78685e732734e0d64ba650cba2107e8">is_mul</a>(Instruction *i);
<a name="l00595"></a>00595 <span class="comment"></span>
<a name="l00596"></a>00596 <span class="comment">/**</span>
<a name="l00597"></a>00597 <span class="comment"> * Determine if an instruction is a DIV instruction.</span>
<a name="l00598"></a>00598 <span class="comment"> *</span>
<a name="l00599"></a>00599 <span class="comment"> * @param i Instruction.</span>
<a name="l00600"></a>00600 <span class="comment"> * @return True if DIV, otherwise false.</span>
<a name="l00601"></a>00601 <span class="comment"> */</span>
<a name="l00602"></a>00602 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="disasm_8h.html#c218b80b0d453d55d61d2b0010638e6b">is_div</a>(Instruction *i);
<a name="l00603"></a>00603 <span class="comment"></span>
<a name="l00604"></a>00604 <span class="comment">/**</span>
<a name="l00605"></a>00605 <span class="comment"> * Determine if an instruction is a SHx instruction.</span>
<a name="l00606"></a>00606 <span class="comment"> *</span>
<a name="l00607"></a>00607 <span class="comment"> * @param i Instruction.</span>
<a name="l00608"></a>00608 <span class="comment"> * @return True if SHx, otherwise false.</span>
<a name="l00609"></a>00609 <span class="comment"> */</span>
<a name="l00610"></a>00610 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="disasm_8h.html#06f009f3de16e3be2eeffb0a41a5a447">is_shift</a>(Instruction *i);
<a name="l00611"></a>00611 <span class="comment"></span>
<a name="l00612"></a>00612 <span class="comment">/**</span>
<a name="l00613"></a>00613 <span class="comment"> * Determine if an instruction is a less common</span>
<a name="l00614"></a>00614 <span class="comment"> * arithmetic instruction.</span>
<a name="l00615"></a>00615 <span class="comment"> *</span>
<a name="l00616"></a>00616 <span class="comment"> * @param i Instruction.</span>
<a name="l00617"></a>00617 <span class="comment"> * @return True if less common arithmetic instruction,</span>
<a name="l00618"></a>00618 <span class="comment"> *         otherwise false.</span>
<a name="l00619"></a>00619 <span class="comment"> */</span>
<a name="l00620"></a>00620 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="disasm_8h.html#bd7026cc81503782514a007dceb5785b">is_uncommon_arithmetic</a>(Instruction *i);
<a name="l00621"></a>00621 <span class="comment"></span>
<a name="l00622"></a>00622 <span class="comment">/**</span>
<a name="l00623"></a>00623 <span class="comment"> * Determine if a register is special-purpose.</span>
<a name="l00624"></a>00624 <span class="comment"> *</span>
<a name="l00625"></a>00625 <span class="comment"> * @param o Operand.</span>
<a name="l00626"></a>00626 <span class="comment"> * @return True if special register, otherwise false.</span>
<a name="l00627"></a>00627 <span class="comment"> */</span>
<a name="l00628"></a>00628 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="disasm_8h.html#6cc0dcd838f675571bcf9f343bd9ae1a">is_special_reg</a>(<a class="code" href="structi386__operand.html">Operand</a> *o);
<a name="l00629"></a>00629 <span class="comment"></span>
<a name="l00630"></a>00630 <span class="comment">/**</span>
<a name="l00631"></a>00631 <span class="comment"> * Instruction digraph node.</span>
<a name="l00632"></a>00632 <span class="comment"> */</span>
<a name="l00633"></a><a class="code" href="struct__inst__digraph__node.html">00633</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__inst__digraph__node.html">_inst_digraph_node</a>
<a name="l00634"></a>00634 {
<a name="l00635"></a><a class="code" href="struct__inst__digraph__node.html#2648ed92a6918dd072ead2484f56ec97">00635</a>   <span class="keyword">struct </span><a class="code" href="struct__inst__digraph__node.html">_inst_digraph_node</a> *<a class="code" href="struct__inst__digraph__node.html#2648ed92a6918dd072ead2484f56ec97">next</a>;
<a name="l00636"></a><a class="code" href="struct__inst__digraph__node.html#74d62d23f21520b243af51fcca0c786f">00636</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="struct__inst__digraph__node.html#74d62d23f21520b243af51fcca0c786f">count</a>;
<a name="l00637"></a><a class="code" href="struct__inst__digraph__node.html#39150f3a54d1c202f1a666a3301342a4">00637</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="struct__inst__digraph__node.html#39150f3a54d1c202f1a666a3301342a4">opcode</a>[6];
<a name="l00638"></a>00638 } <a class="code" href="struct__inst__digraph__node.html">InstDigraphNode</a>;
<a name="l00639"></a>00639 <span class="comment"></span>
<a name="l00640"></a>00640 <span class="comment">/** Digraph hash table size */</span>
<a name="l00641"></a>00641 <span class="preprocessor">#define INST_DIGRAPH_HASH_TABLE_SIZE 1024</span>
<a name="l00642"></a>00642 <span class="preprocessor"></span><span class="comment"></span>
<a name="l00643"></a>00643 <span class="comment">/**</span>
<a name="l00644"></a>00644 <span class="comment"> * Instruction digraphs.</span>
<a name="l00645"></a>00645 <span class="comment"> */</span>
<a name="l00646"></a><a class="code" href="struct__inst__digraphs.html">00646</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__inst__digraphs.html">_inst_digraphs</a>
<a name="l00647"></a>00647 {
<a name="l00648"></a><a class="code" href="struct__inst__digraphs.html#b345af0c432350c22273998e5cf410ad">00648</a>   <a class="code" href="struct__inst__digraph__node.html">InstDigraphNode</a> *<a class="code" href="struct__inst__digraphs.html#b345af0c432350c22273998e5cf410ad">digraphs</a>[INST_DIGRAPH_HASH_TABLE_SIZE];
<a name="l00649"></a><a class="code" href="struct__inst__digraphs.html#fb9a90a0c034df67454d3ace0e22ea52">00649</a>   <a class="code" href="struct__inst__digraph__node.html">InstDigraphNode</a> *<a class="code" href="struct__inst__digraphs.html#fb9a90a0c034df67454d3ace0e22ea52">counts</a>[INST_DIGRAPH_HASH_TABLE_SIZE];
<a name="l00650"></a><a class="code" href="struct__inst__digraphs.html#d1304822adae28d49bda506269f5cf77">00650</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="struct__inst__digraphs.html#d1304822adae28d49bda506269f5cf77">count</a>;
<a name="l00651"></a>00651 } <a class="code" href="struct__inst__digraphs.html">InstDigraphs</a>;
<a name="l00652"></a>00652 <span class="comment"></span>
<a name="l00653"></a>00653 <span class="comment">/** Instruction digraphs */</span>
<a name="l00654"></a>00654 <span class="keyword">extern</span> <a class="code" href="struct__inst__digraphs.html">InstDigraphs</a> <a class="code" href="disasm_8h.html#21ac753b32bc27df72a3d14f1b2506a2">digraphs</a>;
<a name="l00655"></a>00655 <span class="comment"></span>
<a name="l00656"></a>00656 <span class="comment">/**</span>
<a name="l00657"></a>00657 <span class="comment"> * Initialize instruction digraphs.</span>
<a name="l00658"></a>00658 <span class="comment"> *</span>
<a name="l00659"></a>00659 <span class="comment"> * @param g Digraphs.</span>
<a name="l00660"></a>00660 <span class="comment"> */</span>
<a name="l00661"></a>00661 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#d1530b6e80b85431f7f78a583d909adb">inst_digraph_init</a>(<a class="code" href="struct__inst__digraphs.html">InstDigraphs</a> *g);
<a name="l00662"></a>00662 <span class="comment"></span>
<a name="l00663"></a>00663 <span class="comment">/**</span>
<a name="l00664"></a>00664 <span class="comment"> * Destroy instruction digraphs.</span>
<a name="l00665"></a>00665 <span class="comment"> *</span>
<a name="l00666"></a>00666 <span class="comment"> * @param g Digraphs.</span>
<a name="l00667"></a>00667 <span class="comment"> */</span>
<a name="l00668"></a>00668 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#4cc965b2665d6491fc09c494b532fe7f">inst_digraph_destroy</a>(<a class="code" href="struct__inst__digraphs.html">InstDigraphs</a> *g);
<a name="l00669"></a>00669 <span class="comment"></span>
<a name="l00670"></a>00670 <span class="comment">/**</span>
<a name="l00671"></a>00671 <span class="comment"> * Instruction digraph hash function.</span>
<a name="l00672"></a>00672 <span class="comment"> *</span>
<a name="l00673"></a>00673 <span class="comment"> * @param o1 Instruction 1 opcodes.</span>
<a name="l00674"></a>00674 <span class="comment"> * @param o2 Instruction 2 opcodes.</span>
<a name="l00675"></a>00675 <span class="comment"> * @return Hash value.</span>
<a name="l00676"></a>00676 <span class="comment"> */</span>
<a name="l00677"></a>00677 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="disasm_8h.html#ea1beab0616a3d9adab15e1a810f44a9">inst_digraph_hash</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *o1, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *o2);
<a name="l00678"></a>00678 <span class="comment"></span>
<a name="l00679"></a>00679 <span class="comment">/**</span>
<a name="l00680"></a>00680 <span class="comment"> * Instruction count hash function.</span>
<a name="l00681"></a>00681 <span class="comment"> *</span>
<a name="l00682"></a>00682 <span class="comment"> * @param o Instruction opcodes.</span>
<a name="l00683"></a>00683 <span class="comment"> * @return Hash value.</span>
<a name="l00684"></a>00684 <span class="comment"> */</span>
<a name="l00685"></a>00685 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="disasm_8h.html#af29f8c79c16d44e37a325084c8a860e">inst_count_hash</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *o);
<a name="l00686"></a>00686 <span class="comment"></span>
<a name="l00687"></a>00687 <span class="comment">/**</span>
<a name="l00688"></a>00688 <span class="comment"> * Determine if a digraph node is equal to two instructions.</span>
<a name="l00689"></a>00689 <span class="comment"> *</span>
<a name="l00690"></a>00690 <span class="comment"> * @param n Digraph node.</span>
<a name="l00691"></a>00691 <span class="comment"> * @param o1 Instruction 1 opcodes.</span>
<a name="l00692"></a>00692 <span class="comment"> * @param o2 Instruction 2 opcodes.</span>
<a name="l00693"></a>00693 <span class="comment"> * @return True if equal, otherwise false.</span>
<a name="l00694"></a>00694 <span class="comment"> */</span>
<a name="l00695"></a>00695 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="disasm_8h.html#be1ac58fe8b29e57cdcbb76277eff025">inst_digraph_node_equals</a>(<a class="code" href="struct__inst__digraph__node.html">InstDigraphNode</a> *n,
<a name="l00696"></a>00696   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *o1, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *o2);
<a name="l00697"></a>00697 <span class="comment"></span>
<a name="l00698"></a>00698 <span class="comment">/**</span>
<a name="l00699"></a>00699 <span class="comment"> * Determine if a count node is equal to an instruction.</span>
<a name="l00700"></a>00700 <span class="comment"> *</span>
<a name="l00701"></a>00701 <span class="comment"> * @param n Count node.</span>
<a name="l00702"></a>00702 <span class="comment"> * @param o Instruction opcodes.</span>
<a name="l00703"></a>00703 <span class="comment"> * @return True if equal, otherwise false.</span>
<a name="l00704"></a>00704 <span class="comment"> */</span>
<a name="l00705"></a>00705 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="disasm_8h.html#e3f483c7d7f72d4cf4346c1fa84fadba">inst_count_node_equals</a>(<a class="code" href="struct__inst__digraph__node.html">InstDigraphNode</a> *n, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *o);
<a name="l00706"></a>00706 <span class="comment"></span>
<a name="l00707"></a>00707 <span class="comment">/**</span>
<a name="l00708"></a>00708 <span class="comment"> * Increment an instruction digraph count.</span>
<a name="l00709"></a>00709 <span class="comment"> *</span>
<a name="l00710"></a>00710 <span class="comment"> * @param g Digraphs.</span>
<a name="l00711"></a>00711 <span class="comment"> * @param i1 Instruction 1.</span>
<a name="l00712"></a>00712 <span class="comment"> * @param i2 Instruction 2.</span>
<a name="l00713"></a>00713 <span class="comment"> */</span>
<a name="l00714"></a>00714 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#3892d17bfedc5d449511821c004c190f">inst_digraph_incr</a>(<a class="code" href="struct__inst__digraphs.html">InstDigraphs</a> *g, Instruction *i1, Instruction *i2);
<a name="l00715"></a>00715 <span class="comment"></span>
<a name="l00716"></a>00716 <span class="comment">/**</span>
<a name="l00717"></a>00717 <span class="comment"> * Return probability of an instruction digraph.</span>
<a name="l00718"></a>00718 <span class="comment"> *</span>
<a name="l00719"></a>00719 <span class="comment"> * @param g Digraphs.</span>
<a name="l00720"></a>00720 <span class="comment"> * @param i1 Instruction 1.</span>
<a name="l00721"></a>00721 <span class="comment"> * @param i2 Instruction 2.</span>
<a name="l00722"></a>00722 <span class="comment"> * @return Probability.</span>
<a name="l00723"></a>00723 <span class="comment"> */</span>
<a name="l00724"></a>00724 <span class="keywordtype">float</span> <a class="code" href="disasm_8h.html#4412457ef78ca378931af42755379966">inst_digraph_get</a>(<a class="code" href="struct__inst__digraphs.html">InstDigraphs</a> *g, Instruction *i1, Instruction *i2);
<a name="l00725"></a>00725 <span class="comment"></span>
<a name="l00726"></a>00726 <span class="comment">/**</span>
<a name="l00727"></a>00727 <span class="comment"> * Return probability of an instruction.</span>
<a name="l00728"></a>00728 <span class="comment"> *</span>
<a name="l00729"></a>00729 <span class="comment"> * @param g Digraphs.</span>
<a name="l00730"></a>00730 <span class="comment"> * @param i Instruction.</span>
<a name="l00731"></a>00731 <span class="comment"> * @return Probability.</span>
<a name="l00732"></a>00732 <span class="comment"> */</span>
<a name="l00733"></a>00733 <span class="keywordtype">float</span> <a class="code" href="disasm_8h.html#152bdf3596fbe29e1811d1e8dbc54535">inst_count_get</a>(<a class="code" href="struct__inst__digraphs.html">InstDigraphs</a> *g, Instruction *i);
<a name="l00734"></a>00734 <span class="comment"></span>
<a name="l00735"></a>00735 <span class="comment">/**</span>
<a name="l00736"></a>00736 <span class="comment"> * Put count of instruction digraph.</span>
<a name="l00737"></a>00737 <span class="comment"> *</span>
<a name="l00738"></a>00738 <span class="comment"> * @param g Digraphs.</span>
<a name="l00739"></a>00739 <span class="comment"> * @param o1 Instruction 1 opcodes.</span>
<a name="l00740"></a>00740 <span class="comment"> * @param o2 Instruction 2 opcodes.</span>
<a name="l00741"></a>00741 <span class="comment"> * @param c Count.</span>
<a name="l00742"></a>00742 <span class="comment"> */</span>
<a name="l00743"></a>00743 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#3a3cb0509667f686d7e9b3383fae4503">inst_digraph_put</a>(<a class="code" href="struct__inst__digraphs.html">InstDigraphs</a> *g, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *o1,
<a name="l00744"></a>00744   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *o2, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> c);
<a name="l00745"></a>00745 <span class="comment"></span>
<a name="l00746"></a>00746 <span class="comment">/**</span>
<a name="l00747"></a>00747 <span class="comment"> * Put instruction count.</span>
<a name="l00748"></a>00748 <span class="comment"> *</span>
<a name="l00749"></a>00749 <span class="comment"> * @param g Digraphs.</span>
<a name="l00750"></a>00750 <span class="comment"> * @param o Instruction opcodes.</span>
<a name="l00751"></a>00751 <span class="comment"> * @param c Count.</span>
<a name="l00752"></a>00752 <span class="comment"> */</span>
<a name="l00753"></a>00753 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#d17addda177e25b9c429fe80ab72a3b5">inst_count_put</a>(<a class="code" href="struct__inst__digraphs.html">InstDigraphs</a> *g, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *o, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> c);
<a name="l00754"></a>00754 <span class="comment"></span>
<a name="l00755"></a>00755 <span class="comment">/**</span>
<a name="l00756"></a>00756 <span class="comment"> * Parse serialized instruction digraphs.</span>
<a name="l00757"></a>00757 <span class="comment"> *</span>
<a name="l00758"></a>00758 <span class="comment"> * @param g Digraphs.</span>
<a name="l00759"></a>00759 <span class="comment"> * @param s Input stream.</span>
<a name="l00760"></a>00760 <span class="comment"> */</span>
<a name="l00761"></a>00761 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#e9e01a3e8b5d8ae119561c97ae7503f8">inst_digraph_parse</a>(<a class="code" href="struct__inst__digraphs.html">InstDigraphs</a> *g, FILE *s);
<a name="l00762"></a>00762 <span class="comment"></span>
<a name="l00763"></a>00763 <span class="comment">/**</span>
<a name="l00764"></a>00764 <span class="comment"> * Print instruction digraphs.</span>
<a name="l00765"></a>00765 <span class="comment"> *</span>
<a name="l00766"></a>00766 <span class="comment"> * @param g Digraphs.</span>
<a name="l00767"></a>00767 <span class="comment"> */</span>
<a name="l00768"></a>00768 <span class="keywordtype">void</span> <a class="code" href="disasm_8h.html#a0f6f09eb5bad6f5103231902a0dbf14">inst_digraph_print</a>(<a class="code" href="struct__inst__digraphs.html">InstDigraphs</a> *g);
<a name="l00769"></a>00769 <span class="comment"></span>
<a name="l00770"></a>00770 <span class="comment">/**</span>
<a name="l00771"></a>00771 <span class="comment"> * Determine addressing-mode independent register number.</span>
<a name="l00772"></a>00772 <span class="comment"> *</span>
<a name="l00773"></a>00773 <span class="comment"> * @param reg Register number.</span>
<a name="l00774"></a>00774 <span class="comment"> * @return Mode-independent number.</span>
<a name="l00775"></a>00775 <span class="comment"> */</span>
<a name="l00776"></a>00776 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="disasm_8h.html#6968e34eae1447950a73b8390aa95434">indep_regnum</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> reg);
<a name="l00777"></a>00777 <span class="comment"></span>
<a name="l00778"></a>00778 <span class="comment">/**</span>
<a name="l00779"></a>00779 <span class="comment"> * Determine width of register.</span>
<a name="l00780"></a>00780 <span class="comment"> *</span>
<a name="l00781"></a>00781 <span class="comment"> * @param reg Register number.</span>
<a name="l00782"></a>00782 <span class="comment"> * @return Register width as addressing mode.</span>
<a name="l00783"></a>00783 <span class="comment"> */</span>
<a name="l00784"></a>00784 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="disasm_8h.html#80f70194a678fd40689ebee589026f9a">reg_width</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> reg);
<a name="l00785"></a>00785 <span class="comment"></span>
<a name="l00786"></a>00786 <span class="comment">/**</span>
<a name="l00787"></a>00787 <span class="comment"> * Determine width of operand.</span>
<a name="l00788"></a>00788 <span class="comment"> *</span>
<a name="l00789"></a>00789 <span class="comment"> * @param op Operand.</span>
<a name="l00790"></a>00790 <span class="comment"> * @return Width as addressing mode.</span>
<a name="l00791"></a>00791 <span class="comment"> */</span>
<a name="l00792"></a>00792 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="disasm_8h.html#d6ccd5830fde10005feee272bddffe26">op_width</a>(<a class="code" href="structi386__operand.html">Operand</a> *op);
<a name="l00793"></a>00793 <span class="comment"></span>
<a name="l00794"></a>00794 <span class="comment">/**</span>
<a name="l00795"></a>00795 <span class="comment"> * Return a junk score for two instructions.</span>
<a name="l00796"></a>00796 <span class="comment"> *</span>
<a name="l00797"></a>00797 <span class="comment"> * @param last Last instruction.</span>
<a name="l00798"></a>00798 <span class="comment"> * @param cur Current instruction.</span>
<a name="l00799"></a>00799 <span class="comment"> * @return Junk instruction score.</span>
<a name="l00800"></a>00800 <span class="comment"> */</span>
<a name="l00801"></a>00801 <span class="keywordtype">float</span> <a class="code" href="disasm_8h.html#f2eea88844d6ac7576a8bbc70af23fe3">score_junk_insts</a>(Instruction *last, Instruction *cur);
<a name="l00802"></a>00802 <span class="comment"></span>
<a name="l00803"></a>00803 <span class="comment">/**</span>
<a name="l00804"></a>00804 <span class="comment"> * Detect if a given run of instructions is likely</span>
<a name="l00805"></a>00805 <span class="comment"> * junk.</span>
<a name="l00806"></a>00806 <span class="comment"> *</span>
<a name="l00807"></a>00807 <span class="comment"> * @param start Start position.</span>
<a name="l00808"></a>00808 <span class="comment"> * @param end End position.</span>
<a name="l00809"></a>00809 <span class="comment"> * @return Instruction anomaly score.</span>
<a name="l00810"></a>00810 <span class="comment"> *         (0.0 valid, 1.0 junk)</span>
<a name="l00811"></a>00811 <span class="comment"> */</span>
<a name="l00812"></a>00812 <span class="keywordtype">float</span> <a class="code" href="disasm_8h.html#51c54cd44d8cadbccee57a12b7558d91">detect_junk_insts</a>(bfd_vma start, bfd_vma end);
<a name="l00813"></a>00813 <span class="comment"></span>
<a name="l00814"></a>00814 <span class="comment">/**</span>
<a name="l00815"></a>00815 <span class="comment"> * Update a previously-computed junk instruction score</span>
<a name="l00816"></a>00816 <span class="comment"> * taking into account a new instruction which prefaces</span>
<a name="l00817"></a>00817 <span class="comment"> * the previous run.</span>
<a name="l00818"></a>00818 <span class="comment"> *</span>
<a name="l00819"></a>00819 <span class="comment"> * @param new New instruction.</span>
<a name="l00820"></a>00820 <span class="comment"> * @param next Next instruction.</span>
<a name="l00821"></a>00821 <span class="comment"> * @param orig Original score.</span>
<a name="l00822"></a>00822 <span class="comment"> * @param num Length of original run.</span>
<a name="l00823"></a>00823 <span class="comment"> * @return Updated junk score.</span>
<a name="l00824"></a>00824 <span class="comment"> */</span>
<a name="l00825"></a>00825 <span class="keywordtype">float</span> <a class="code" href="disasm_8h.html#139dddb45a7b6a42127ad1ac05e8738f">update_junk_score</a>(Instruction *newinstr, Instruction *next,
<a name="l00826"></a>00826             <span class="keywordtype">float</span> orig, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> num);
<a name="l00827"></a>00827 
<a name="l00828"></a>00828 
<a name="l00829"></a>00829 
<a name="l00830"></a>00830 <span class="comment">/******************************************************************************/</span>
<a name="l00831"></a>00831 <span class="comment">/*                           Symbolic Execution Code                          */</span>
<a name="l00832"></a>00832 <span class="comment">/******************************************************************************/</span>
<a name="l00833"></a>00833 
<a name="l00834"></a>00834 
<a name="l00835"></a>00835 <span class="comment">/* struct _machine_state {</span>
<a name="l00836"></a>00836 <span class="comment"></span>
<a name="l00837"></a>00837 <span class="comment">  unsigned long registers[8];</span>
<a name="l00838"></a>00838 <span class="comment"></span>
<a name="l00839"></a>00839 <span class="comment"></span>
<a name="l00840"></a>00840 <span class="comment"></span>
<a name="l00841"></a>00841 <span class="comment"></span>
<a name="l00842"></a>00842 <span class="comment">} MState;</span>
<a name="l00843"></a>00843 <span class="comment">*/</span>
<a name="l00844"></a>00844 
<a name="l00845"></a>00845 
<a name="l00846"></a>00846 
<a name="l00847"></a>00847 
<a name="l00848"></a>00848 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00849"></a>00849 <span class="preprocessor"></span>}
<a name="l00850"></a>00850 <span class="preprocessor">#endif</span>
<a name="l00851"></a>00851 <span class="preprocessor"></span>
<a name="l00852"></a>00852 
<a name="l00853"></a>00853 <span class="preprocessor">#endif</span>
</pre></div></div>
<hr>
<p class="footer">
Generated on Fri Mar 30 16:18:24 2012 for <a href="http://bitblaze.cs.berkeley.edu/temu.html">TEMU</a> by
<a href="http://www.doxygen.org"><img src="doxygen.png" alt="Doxygen"
align="middle" border="0"/>1.5.8</a><br/>
Copyright &copy; 2008-2009, BitBlaze Project. All Rights Reserved.</p>

<hr>
<!--#include virtual="/attrib.incl" -->

</body>
</html>
